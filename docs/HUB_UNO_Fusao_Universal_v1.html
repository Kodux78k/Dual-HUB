<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>HUB Dual — Variante B</title>
<link rel="icon" href="icons/others/favicon.svg" type="image/svg+xml"/>
<meta name="theme-color" content="#00ffff"/>
<style>
  :root{
    --bg1:#f03bff; --bg2:#14f0ff;
    --ink:#f4f7ff; --ink-muted:#a9bdd9; --edge:#ffffff18;
    --h:84px; --f:72px; --radius:30px; --pad:16px; --blur:18px;
    --shadow:0 18px 38px rgba(0,0,0,.40);
  }
  *{box-sizing:border-box}
  body{
    margin:0; font:400 15px/1.45 ui-sans-serif,system-ui,Inter,Segoe UI,Roboto,Arial; color:var(--ink);
    background:
      radial-gradient(1100px 1000px at 8% -10%, #ff6bff33, transparent 60%),
      radial-gradient(1100px 1000px at 110% 110%, #6bffff33, transparent 60%),
      linear-gradient(42deg,var(--bg1),var(--bg2)); background-attachment:fixed;
  }
  .glass{background:#0a0a12ee; border:1px solid var(--edge); backdrop-filter:blur(var(--blur))}
  header{position:fixed; inset:0 0 auto 0; height:var(--h); padding:0 var(--pad); z-index:30; display:flex; align-items:center; gap:12px; border-bottom:1px solid var(--edge); box-shadow:var(--shadow); border-bottom-left-radius:18px; border-bottom-right-radius:18px}
  .title{font-weight:900; font-size:34px; letter-spacing:.2px}
  .grow{flex:1}
  .pill{width:44px;height:44px;border-radius:16px;border:1px solid var(--edge);display:grid;place-content:center;background:#0e0e18cc;cursor:pointer}
  main{padding:calc(var(--h) + 16px) 14px calc(var(--f) + 16px)}
  .card{border-radius:24px;padding:14px;border:1px solid var(--edge);background:#0b0b15e6;box-shadow:var(--shadow)}
  .muted{color:var(--ink-muted)}
  .divider{height:1px;background:var(--edge);margin:12px 0}
  .appsGrid{display:grid;gap:12px}
  .appRow{display:flex;gap:14px;align-items:center;border:1px solid var(--edge);background:#0a0a14f2;border-radius:20px;padding:12px}
  .appRow img{width:36px;height:36px;border-radius:12px;border:1px solid var(--edge);background:#080812}
  .btn{border:1px solid var(--edge);background:#0e0e1acc;color:var(--ink);padding:9px 13px;border-radius:14px;cursor:pointer;font-size:13px}
  .btn.pri{background:linear-gradient(42deg,#52f3ffcc,#d19affcc)}
  .btn.star[data-on="true"]{background:linear-gradient(42deg,#ffd36ecc,#ff8f6ecc);color:#2c1200}
  .session{margin:16px 0;border-radius:26px;border:1px solid var(--edge);overflow:hidden;background:#090912f2;box-shadow:var(--shadow)}
  .sHead{display:flex;gap:12px;align-items:center;padding:12px;background:#0b0b16e8}
  .sBtns{display:flex;gap:9px;margin-left:auto}
  .sBtn{width:36px;height:36px;border-radius:12px;border:1px solid var(--edge);background:#0f0f1bcc;display:grid;place-content:center;cursor:pointer}
  .sBody{height:460px;border-top:1px solid var(--edge);background:#07070e}
  .sBody iframe{width:100%;height:100%;border:0}
  footer{position:fixed; inset:auto 0 0 0; height:var(--f); padding:10px 14px; z-index:32; display:flex; align-items:center; gap:12px; border-top:1px solid var(--edge); box-shadow:var(--shadow)}
  .iconbtn{width:40px;height:40px;border-radius:14px;border:1px solid var(--edge);display:grid;place-content:center;background:#0e0e19cc;cursor:pointer}
  .quick{flex:1;display:flex;gap:10px;overflow:auto;scrollbar-width:none}
  .quick::-webkit-scrollbar{display:none}
  .mini{display:inline-flex;gap:8px;align-items:center;background:#0e0e19cc;border:1px solid var(--edge);border-radius:999px;padding:7px 11px}
  .dot{width:9px;height:9px;border-radius:50%;background:linear-gradient(42deg,#7ff,#f9f);box-shadow:0 0 12px #7ff}
  #brain{position:fixed; top:calc(var(--h) + 12px); right:14px; width:min(92vw,440px); z-index:40}
  .popover{border-radius:24px;padding:12px;background:#0a0a13f2;border:1px solid var(--edge);backdrop-filter:blur(var(--blur))}
  .menuItem{display:flex;gap:12px;align-items:center;border:1px solid var(--edge);background:#0c0c17e6;border-radius:16px;padding:12px}
  .menuItem + .menuItem{margin-top:9px}
  .input{display:flex;gap:8px;align-items:center;background:#090915;border:1px solid var(--edge);border-radius:14px;padding:9px 11px}
  .input input,.input select{flex:1;background:transparent;border:0;outline:0;color:var(--ink);font-size:13px}
  .notice{font-size:12px;color:var(--ink-muted)}
  .hide{display:none!important}
  svg{display:block}
</style>
</head>
<body>
  <header class="glass">
    <div class="title">HUB Dual</div>
    <div class="grow"></div>
    <button class="pill" id="btnDownload" title="Baixar"><img src="icons/others/hub_download.svg" width="20" height="20" onerror="this.replaceWith(svgDL())" alt=""></button>
    <button class="pill" id="btnBrain" title="Brain"><img src="icons/others/hub_perfil.svg" width="20" height="20" onerror="this.replaceWith(svgUser())" alt=""></button>
  </header>

  <main>
    <section id="sessionsAnchor"></section>

    <section class="card">
      <div class="row" style="display:flex;justify-content:space-between;align-items:center">
        <div><div style="font-weight:700">Home</div><div class="muted">Empilhe apps; minimize e reabra no dock.</div></div>
        <div class="row muted" style="display:flex;align-items:center;gap:8px"><img src="icons/others/hub_lightning.svg" width="18" height="18" onerror="this.replaceWith(svgBolt(18))" alt=""> Nebula Pro</div>
      </div>
      <div class="divider"></div>

      <div id="favoritesWrap" class="hide">
        <div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">Favoritos</div><div class="muted">seus fixados</div></div>
        <div id="favoritesList" class="appsGrid" style="margin-top:8px"></div>
        <div class="divider"></div>
      </div>

      <div id="groupsWrap" class="appsGrid"></div>
    </section>

    <section class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Minimizados</div><div class="muted" id="miniCount">0</div>
      </div>
      <div id="miniWrap" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px"></div>
    </section>
  </main>

  <footer class="glass">
    <button class="iconbtn" id="btnHome"><img src="icons/others/hub_home.svg" width="20" height="20" onerror="this.replaceWith(svgHome())" alt=""></button>
    <button class="iconbtn" id="btnApps"><img src="icons/others/hub_apps.svg" width="20" height="20" onerror="this.replaceWith(svgApps())" alt=""></button>
    <div class="quick" id="quickBadges"></div>
    <button class="iconbtn" id="btnLogs"><img src="icons/others/hub_relatorio.svg" width="20" height="20" onerror="this.replaceWith(svgList())" alt=""></button>
  </footer>

  <div id="brain" class="hide">
    <div class="popover">
      <div class="menuItem" style="cursor:default"><img src="icons/others/hub_memoria.svg" width="22" height="22" onerror="this.replaceWith(svgUser())" alt=""><div style="flex:1"><div style="font-weight:700">Perfil</div><div class="notice">Nome e rótulo do seu Dual</div></div></div>
      <div class="input" style="margin-top:8px"><input id="inpName" placeholder="Seu nome"></div>
      <div class="input" style="margin-top:8px"><input id="inpDual" placeholder="Nome do seu Dual"></div>

      <div class="menuItem" style="cursor:default; margin-top:8px"><img src="icons/others/hub_cloud.svg" width="22" height="22" onerror="this.replaceWith(svgKey())" alt=""><div style="flex:1"><div style="font-weight:700">Chave SK (OpenRouter)</div><div class="notice">Guardada localmente</div></div></div>
      <div class="input" style="margin-top:8px"><input id="inpSK" placeholder="sk-..."><button class="btn" id="btnSaveSK">Salvar</button></div>

      <div class="menuItem" style="cursor:default; margin-top:8px"><img src="icons/others/hub_health.svg" width="22" height="22" onerror="this.replaceWith(svgPerf())" alt=""><div style="flex:1"><div style="font-weight:700">Performance</div><div class="notice" id="perfLabel">Med</div></div></div>
      <div class="input" style="margin-top:8px"><select id="selPerf"><option value="low">Low</option><option value="med" selected>Med</option><option value="high">High</option></select><button class="btn" id="btnPerf">Aplicar</button></div>

      <div class="menuItem" style="cursor:default; margin-top:8px"><img src="icons/others/hub_bind.svg" width="22" height="22" onerror="this.replaceWith(svgVoice())" alt=""><div style="flex:1"><div style="font-weight:700">Vozes / TTS</div><div class="notice">menu por arquétipo (placeholder)</div></div></div>
      <div class="input" style="margin-top:8px"><select id="selVoice"><option>Nova</option><option>Elysha</option><option>Kaion</option><option>Serena</option></select><button class="btn" id="btnVoice">Salvar</button></div>

      <div class="menuItem" id="btnClear" style="margin-top:8px"><img src="icons/others/hub_memoria.svg" width="22" height="22" onerror="this.replaceWith(svgTrash())" alt=""><div style="flex:1"><div style="font-weight:700">Limpar Memória</div><div class="notice">apaga preferências e favoritos</div></div></div>

      <div class="menuItem" style="cursor:default; margin-top:8px"><img src="icons/others/hub_relatorio.svg" width="22" height="22" onerror="this.replaceWith(svgList())" alt=""><div style="flex:1"><div style="font-weight:700">Logs</div><div class="notice">eventos recentes</div></div></div>
      <div class="card" style="margin-top:8px;max-height:140px;overflow:auto"><pre id="logs" style="margin:0;font:12px/1.4 ui-monospace,monospace;color:var(--ink-muted)"></pre></div>
    </div>
  </div>

<script>
const $ = s=>document.querySelector(s);
function svgWrap(s){const x=document.createElement('span');x.innerHTML=s.trim();return x.firstChild}
function svgDL(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><path d="M12 3v12"/><path d="M8 11l4 4 4-4"/><rect x="4" y="19" width="16" height="2" rx="1" fill="currentColor"/></svg>`)}
function svgUser(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>`)}
function svgKey(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><circle cx="8" cy="15" r="4"/><path d="M12 15h10l-2 2 2 2-2 2"/></svg>`)}
function svgPerf(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><path d="M4 19a8 8 0 1 1 16 0"/><path d="M12 12v4"/><path d="M7 12v2"/><path d="M17 12v3"/></svg>`)}
function svgVoice(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><rect x="9" y="3" width="6" height="12" rx="3"/><path d="M5 10a7 7 0 0 0 14 0"/><path d="M12 17v4"/></svg>`)}
function svgTrash(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><rect x="6" y="6" width="12" height="14" rx="2"/></svg>`)}
function svgHome(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><path d="M3 11L12 3l9 8"/><path d="M5 10v10h14V10"/></svg>`)}
function svgApps(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><rect x="3" y="3" width="7" height="7" rx="2"/><rect x="14" y="3" width="7" height="7" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/><rect x="14" y="14" width="7" height="7" rx="2"/></svg>`)}
function svgList(s=20){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="none" stroke="currentColor" stroke-width="1.7"><path d="M9 6h12M9 12h12M9 18h12"/><circle cx="4" cy="6" r="1.6"/><circle cx="4" cy="12" r="1.6"/><circle cx="4" cy="18" r="1.6"/></svg>`)}
function svgBolt(s=18){return svgWrap(`<svg viewBox="0 0 24 24" width="${s}" height="${s}" fill="currentColor"><path d="M13 3L4 14h6l-1 7 9-11h-6l1-7z"/></svg>`)}
const state={sessions:[],favorites:new Set(JSON.parse(localStorage.getItem('hub.favs')||'[]')),profile:JSON.parse(localStorage.getItem('hub.profile')||'{}'),perf:localStorage.getItem('hub.perf')||'med',voice:localStorage.getItem('hub.voice')||'Nova',sk:localStorage.getItem('hub.sk')||'',logs:[]};
function log(m){const l=`[${new Date().toLocaleTimeString()}] ${m}`;state.logs.unshift(l);$('#logs').textContent=state.logs.slice(0,60).join('\n')}
$('#btnBrain').addEventListener('click',()=>$('#brain').classList.toggle('hide'));
document.addEventListener('click',e=>{const b=$('#brain'); if(!b.classList.contains('hide') && !b.contains(e.target) && !$('#btnBrain').contains(e.target)) b.classList.add('hide')});
function loadProfileUI(){ $('#inpName').value=state.profile.name||''; $('#inpDual').value=state.profile.dual||''; $('#inpSK').value=state.sk; $('#selPerf').value=state.perf; $('#perfLabel').textContent=state.perf.toUpperCase(); $('#selVoice').value=state.voice; }
['inpName','inpDual'].forEach(id=>$('#'+id).addEventListener('change',()=>{state.profile.name=$('#inpName').value.trim();state.profile.dual=$('#inpDual').value.trim();localStorage.setItem('hub.profile',JSON.stringify(state.profile));log('Perfil atualizado')}))
$('#btnSaveSK').addEventListener('click',()=>{state.sk=$('#inpSK').value.trim();localStorage.setItem('hub.sk',state.sk);log('SK salva')})
$('#btnPerf').addEventListener('click',()=>{state.perf=$('#selPerf').value;localStorage.setItem('hub.perf',state.perf);$('#perfLabel').textContent=state.perf.toUpperCase();log('Performance: '+state.perf)})
$('#btnVoice').addEventListener('click',()=>{state.voice=$('#selVoice').value;localStorage.setItem('hub.voice',state.voice);log('Voz setada: '+state.voice)})
$('#btnDownload').addEventListener('click',()=>{fetch(location.href).then(r=>r.text()).then(t=>{const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([t],{type:'text/html'}));a.download='HUB_Dual_VarB.html';a.click();URL.revokeObjectURL(a.href);log('HTML baixado')}).catch(()=>{const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([document.documentElement.outerHTML],{type:'text/html'}));a.download='HUB_Dual_VarB_runtime.html';a.click();URL.revokeObjectURL(a.href);log('HTML baixado (runtime)')})})
const groupsWrap=$('#groupsWrap'), favoritesWrap=$('#favoritesWrap'), favoritesList=$('#favoritesList');
async function loadApps(){ try{ const res=await fetch('./apps/apps.json',{cache:'no-store'}); const data=await res.json(); const groups=data.groups||{}; groupsWrap.innerHTML=''; for(const [n,items] of Object.entries(groups)){ const card=document.createElement('div'); card.className='card'; card.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">${n.replaceAll('_',' ')}</div><div class=muted>${items.length} apps</div></div><div class=appsGrid></div>`; const list=card.querySelector('.appsGrid'); items.forEach(app=>{ const row=document.createElement('div'); row.className='appRow'; const icon=app.icon||'icons/others/hub_apps.svg'; row.innerHTML=`<img src="${icon}" onerror="this.replaceWith(svgApps(32))" alt=""><div style="flex:1;min-width:0"><div style="font-weight:700">${app.title||app.key}</div><div class="muted" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis" title="${app.desc||''}">${app.desc||''}</div></div><div style="display:flex;gap:10px"><button class="btn star" data-key="${app.key}" data-on="${state.favorites.has(app.key)}">★</button><button class="btn pri" onclick="openSession('${app.key}','${(app.title||app.key).replace(/['\"<>&]/g,'')}', '${app.url||''}', '${icon}')">Abrir</button></div>`; list.appendChild(row)}); groupsWrap.appendChild(card);} renderFavorites(); log('apps.json carregado') }catch(e){ groupsWrap.innerHTML='<div class=muted>Falha ao carregar apps/apps.json</div>'; log('Erro apps.json') } }
document.addEventListener('click',e=>{const star=e.target.closest('.btn.star'); if(!star)return; const key=star.dataset.key; const on=star.getAttribute('data-on')==='true'; if(on)state.favorites.delete(key); else state.favorites.add(key); star.setAttribute('data-on', String(!on)); localStorage.setItem('hub.favs', JSON.stringify([...state.favorites])); renderFavorites(); });
function renderFavorites(){ favoritesList.innerHTML=''; const favs=[...state.favorites]; favoritesWrap.classList.toggle('hide',favs.length===0); if(!favs.length) return; const all=groupsWrap.querySelectorAll('.appRow'); favs.forEach(k=>{ const row=[...all].find(r=>r.querySelector('.btn.star')?.dataset.key===k); if(row){ const c=row.cloneNode(true); c.querySelector('.btn.star').remove(); favoritesList.appendChild(c);} }); }
const sessionsAnchor=$('#sessionsAnchor'), miniWrap=$('#miniWrap'), miniCount=$('#miniCount'), quickBadges=$('#quickBadges');
function openSession(key,title,url,icon){ const id='S'+Date.now().toString(36); const el=document.createElement('section'); el.className='session'; el.id=id; el.innerHTML=`<div class="sHead"><img src="${icon}" width="18" height="18" onerror="this.replaceWith(svgApps(18))" alt=""><div style="font-weight:700">${title}</div><div class="sBtns"><button class="sBtn" onclick="minimizeSession('${id}')">${svgWrap('<svg viewBox=0 0 24 24 width=18 height=18 fill=none stroke=currentColor stroke-width=1.7><path d=M5 12h14/></svg>').outerHTML}</button><button class="sBtn" onclick="closeSession('${id}')">${svgWrap('<svg viewBox=0 0 24 24 width=18 height=18 fill=none stroke=currentColor stroke-width=1.7><path d=M6 6 18 18/><path d=M18 6 6 18/></svg>').outerHTML}</button></div></div><div class="sBody"><iframe src="${url}"></iframe></div>`; sessionsAnchor.prepend(el); addBadge({id,title}); log('Sessão aberta: '+title); window.scrollTo({top:0,behavior:'smooth'}); }
function minimizeSession(id){document.getElementById(id)?.classList.add('hide'); addBadge({id,title:document.querySelector('#'+id+' .sHead div[style*="font-weight"]')?.textContent||'App'}); renderMinimized(); log('Minimizada')}
function closeSession(id){document.getElementById(id)?.remove(); removeBadge(id); renderMinimized(); log('Fechada')}
function addBadge(s){if(quickBadges.querySelector(`[data-id="${s.id}"]`)) return; const b=document.createElement('button'); b.className='mini'; b.dataset.id=s.id; b.innerHTML=`<span class="dot"></span> <span>${s.title}</span>`; b.onclick=()=>restoreSession(s.id); quickBadges.prepend(b)}
function removeBadge(id){quickBadges.querySelector(`[data-id="${id}"]`)?.remove()}
function renderMinimized(){const m=[...document.querySelectorAll('.session.hide')]; miniWrap.innerHTML=''; m.forEach(e=>{const t=e.querySelector('.sHead div[style*="font-weight"]')?.textContent||'App'; const c=document.createElement('button'); c.className='mini'; c.innerHTML=`<span class="dot"></span> ${t}`; c.onclick=()=>restoreSession(e.id); miniWrap.appendChild(c)}); miniCount.textContent=m.length}
function restoreSession(id){document.getElementById(id)?.classList.remove('hide'); renderMinimized(); log('Reaberta')}
$('#btnHome').addEventListener('click',()=>window.scrollTo({top:sessionsAnchor.offsetTop+1,behavior:'smooth'}))
$('#btnApps').addEventListener('click',()=>{const y=$('#groupsWrap').getBoundingClientRect().top+scrollY-90; window.scrollTo({top:y,behavior:'smooth'})})
$('#btnLogs').addEventListener('click',()=>{$('#brain').classList.remove('hide'); $('#brain').scrollIntoView({behavior:'smooth',block:'nearest'})})
loadApps(); loadProfileUI(); log('Hub iniciado');

// ====== Fusão Universal: Legacy embed ======
const LEGACY_B64 = "PCEtLQogIEVzdGEgw6kgYSB2ZXJzw6NvIGZpbmFsIHVuaWZpY2FkYSBkbyBIVUIgVU5PIGUgZG8gSHViIFJldm8uCiAgRWxhIHNlIGJhc2VpYSBubyBhcnF1aXZvIOKAnHVuaWZpY2FkbyAzLmh0bWzigJ0gKE1vbsOzbGl0byBVTk8pIGUgaW5jb3Jwb3JhCiAgdW1hIG5vdmEgYWJhIGNoYW1hZGEg4oCcUmV2b+KAnSwgcXVlIGNhcnJlZ2EgbyBIdWIgSW5mb2Rvc2UgVWx0cmEgZW0gdW0KICBpZnJhbWUuICBPIGPDs2RpZ28gZG8gUmV2byBmb2kgY29waWFkbyBwYXJhIOKAnGluZGV4LTEwMF9yZXZvX21vZC5odG1s4oCdIGUKICBsZXZlbWVudGUgbW9kaWZpY2FkbyBwYXJhIGJ1c2NhciBhIGxpc3RhIGRlIGFwcHMgZGlyZXRhbWVudGUgZG8KICBlbGVtZW50byA8c2NyaXB0IGlkPSJBUFBTX0pTT04iPiBwcmVzZW50ZSBuZXN0YSBww6FnaW5hLiAgSXNzbwogIGFzc2VndXJhIHF1ZSBhbWJvcyBvcyBodWJzIGNvbXBhcnRpbGhhbSBvIG1lc21vIGNhdMOhbG9nbyBkZSBhcHBzIHNlbQogIGRlcGVuZGVyIGRlIGFycXVpdm9zIGV4dGVybm9zIGF1c2VudGVzLgotLT4KPCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9InB0LUJSIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0idXRmLTgiIC8+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLCB2aWV3cG9ydC1maXQ9Y292ZXIsIG1heGltdW0tc2NhbGU9MSwgdXNlci1zY2FsYWJsZT1ubyIgLz4KICA8dGl0bGU+SFVCIFVOTyDigJQgVW5pZmllZCBNaW5pbWFsIEdsb3cgKyBSZXZvPC90aXRsZT4KICA8bWV0YSBuYW1lPSJ0aGVtZS1jb2xvciIgY29udGVudD0iIzBiMGYxNCIgLz4KICA8c3R5bGU+CiAgICA6cm9vdCB7CiAgICAgIC8qIFBhbGV0YSBwYWRyw6NvIChyb3NhL2F6dWwpICovCiAgICAgIC0tZ3JhZC1hOiAjZmY1MmU1OwogICAgICAtLWdyYWQtYjogIzAwYzVlNTsKICAgICAgLS1mZzogI2Y1ZjdmZjsKICAgICAgLS1tdXQ6IHJnYmEoMjQ1LCAyNDcsIDI1NSwgLjY4KTsKICAgICAgLS1zdXJmYWNlOiByZ2JhKDE1LCAxNywgMzIsIC41MCk7CiAgICAgIC0tc3VyZmFjZS1zdHJvbmc6IHJnYmEoMTUsIDE3LCAzMiwgLjg4KTsKICAgICAgLS1iZDogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgLjEyKTsKICAgICAgLS1vazogIzM5ZmZiNjsKICAgICAgLS13YXJuOiAjZmZiODZiOwogICAgICAtLWVycjogI2ZmNmI2YjsKICAgICAgLS1yOiAxOHB4OwogICAgICAtLXIyOiAyMnB4OwogICAgICAtLXNoYWRvdzogMCAxNHB4IDQwcHggcmdiYSgwLCAwLCAwLCAuNDUpOwogICAgICAtLXRhYnNIOiA3NHB4OwogICAgICAtLWhkckg6IDY0cHg7CiAgICAgIC0tYmx1cjogMThweDsKICAgICAgLS1lYXNlOiBjdWJpYy1iZXppZXIoLjIyLCAuNjEsIC4zNiwgMSk7CiAgICB9CgogICAgLyogVGVtYSBhbHRlcm5hdGl2bzogbWVkaXVtIGdyYXkgLyBnbGFzbW9yZmlzbW8uIFF1YW5kbyBib2R5W2RhdGEtdGhlbWU9Im1lZGl1bSJdIGVzdGl2ZXIgZGVmaW5pZG8sIGVzdGFzIHZhcmnDoXZlaXMgc3Vic3RpdHVlbSBhcyBvcmlnaW5haXMuICovCiAgICBib2R5W2RhdGEtdGhlbWU9Im1lZGl1bSJdIHsKICAgICAgLyogQWp1c3RhbW9zIGEgcGFsZXRhIOKAnG1lZGl1beKAnSBwYXJhIHVtIHZpc3VhbCBhaW5kYSBtYWlzIHRlY25vbMOzZ2ljbywKICAgICAgICAgY29tIHRvbnMgZGUgY2luemEtZXNjdXJvL2F6dWxhZG8gZSB0cmFuc3BhcsOqbmNpYXMgc3VhdmVzIHBhcmEKICAgICAgICAgcmVmb3LDp2FyIG8gZ2xhc21vcmZpc21vLiAqLwogICAgICAtLWdyYWQtYTogIzJjMzEzYzsKICAgICAgLS1ncmFkLWI6ICMxZjI0MmQ7CiAgICAgIC0tZmc6ICNmMWYyZjU7CiAgICAgIC0tbXV0OiByZ2JhKDI0MSwgMjQyLCAyNDUsIC42OCk7CiAgICAgIC0tc3VyZmFjZTogcmdiYSg0NCwgNDcsIDU2LCAuNDApOwogICAgICAtLXN1cmZhY2Utc3Ryb25nOiByZ2JhKDQ0LCA0NywgNTYsIC43NSk7CiAgICAgIC0tYmQ6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIC4wNik7CiAgICAgIC0tb2s6ICM2OGQzOTE7CiAgICAgIC0td2FybjogI2Y2YWQ1NTsKICAgICAgLS1lcnI6ICNmYzgxODE7CiAgICAgIC0tYmx1cjogMjRweDsKICAgIH0KCiAgICAqIHsgYm94LXNpemluZzogYm9yZGVyLWJveCB9CiAgICBodG1sLCBib2R5IHsgaGVpZ2h0OiAxMDAlIH0KCiAgICBib2R5IHsKICAgICAgbWFyZ2luOiAwOwogICAgICBjb2xvcjogdmFyKC0tZmcpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoNDJkZWcsIHZhcigtLWdyYWQtYSksIHZhcigtLWdyYWQtYikpIGZpeGVkOwogICAgICBmb250OiAxNHB4LzEuNDUgSW50ZXIsIHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgU2Vnb2UgVUksIFJvYm90bywgQXJpYWw7CiAgICAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkOwogICAgICB0ZXh0LXJlbmRlcmluZzogb3B0aW1pemVMZWdpYmlsaXR5OwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgfQoKICAgIC8qID09PT09IE1pY3JvLWludGVyYcOnw7VlcyBiYXNlID09PT09ICovCiAgICAuZngtdHJhbnMgeyB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gLjE2cyB2YXIoLS1lYXNlKSwgYmFja2dyb3VuZCAuMjVzIHZhcigtLWVhc2UpLCBib3gtc2hhZG93IC4yNXMgdmFyKC0tZWFzZSksIGJvcmRlci1jb2xvciAuMjVzIHZhcigtLWVhc2UpLCBjb2xvciAuMjVzIHZhcigtLWVhc2UpLCBvcGFjaXR5IC4yNXMgdmFyKC0tZWFzZSkgfQogICAgLmZ4LWxpZnQ6aG92ZXIgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCkgfQogICAgLmZ4LXByZXNzOmFjdGl2ZSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKSBzY2FsZSguOTgpIH0KICAgIC5yaW5nOmZvY3VzLXZpc2libGUgeyBvdXRsaW5lOiAwOyBib3gtc2hhZG93OiAwIDAgMCA0cHggcmdiYSgyNTUsMjU1LDI1NSwuMTQpIH0KICAgIEBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKSB7IC5meC10cmFucyB7IHRyYW5zaXRpb246IG5vbmUgfSB9CgogICAgLyogPT09PT0gQm90w7VlcyA9PT09PSAqLwogICAgYnV0dG9uLCAuYnRuLCAuaWIgeyBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlKTsgYm9yZGVyOiB2YXIoLS1iZCk7IGNvbG9yOiB2YXIoLS1mZyk7IGZvbnQtd2VpZ2h0OiA4MDA7IGJvcmRlci1yYWRpdXM6IDEycHg7IGN1cnNvcjogcG9pbnRlcjsgcG9zaXRpb246IHJlbGF0aXZlIH0KICAgIC5idG4geyBwYWRkaW5nOiAuNThyZW0gLjlyZW07IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxODBkZWcsICMxMTE2MmEsICMwYjExMjIpIH0KICAgIC5idG4ucHJpbWUgeyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNhNjZmZmYsICM2ZGI0ZmYpOyBjb2xvcjogIzBiMGYxNDsgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudCB9CiAgICAuYnRuOmhvdmVyIHsgYm94LXNoYWRvdzogMCA4cHggMjZweCByZ2JhKDAsMCwwLC4zNiksIDAgMCAwIDFweCByZ2JhKDI1NSwyNTUsMjU1LC4xMCkgaW5zZXQgfQogICAgLmJ0bi5wcmltZTpob3ZlciB7IGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMTY2LDExMSwyNTUsLjI2KSwgMCAwIDAgMXB4IHJnYmEoMjU1LDI1NSwyNTUsLjE4KSBpbnNldCB9CiAgICAuYnRuOmFjdGl2ZSB7IGZpbHRlcjogc2F0dXJhdGUoMS4wMikgYnJpZ2h0bmVzcyguOTgpIH0KICAgIC5idG5bZGlzYWJsZWRdIHsgb3BhY2l0eTogLjU1OyBwb2ludGVyLWV2ZW50czogbm9uZSB9CgogICAgLyogUmlwcGxlICovCiAgICAucmlwcGxlIHsgcG9zaXRpb246IGFic29sdXRlOyBpbnNldDogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyLXJhZGl1czogaW5oZXJpdCB9CiAgICAucmlwcGxlID4gaSB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgYm9yZGVyLXJhZGl1czogOTk5cHg7IHBvaW50ZXItZXZlbnRzOiBub25lOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNsb3Nlc3Qtc2lkZSwgcmdiYSgyNTUsMjU1LDI1NSwuMzUpLCByZ2JhKDI1NSwyNTUsMjU1LDApIDcwJSk7IGFuaW1hdGlvbjogcmlwcGxlIC42cyB2YXIoLS1lYXNlKSBmb3J3YXJkcyB9CiAgICBAa2V5ZnJhbWVzIHJpcHBsZSB7IGZyb20geyBvcGFjaXR5OiAuNTU7IHdpZHRoOiAwOyBoZWlnaHQ6IDAgfSB0byB7IG9wYWNpdHk6IDA7IHdpZHRoOiAyNjBweDsgaGVpZ2h0OiAyNjBweCB9IH0KCiAgICAvKiA9PT09PSBIZWFkZXIgPT09PT0gKi8KICAgIGhlYWRlci5tYXN0IHsgcG9zaXRpb246IHJlbGF0aXZlOyBpbnNldDogMCAwIGF1dG8gMDsgaGVpZ2h0OiB2YXIoLS1oZHJIKTsgei1pbmRleDogMTAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDEwcHg7IHBhZGRpbmc6IDAgMTJweDsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKHZhcigtLWJsdXIpKSBzYXR1cmF0ZSgxMzAlKTsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE4MGRlZywgcmdiYSgwLDAsMCwuMjgpLCByZ2JhKDAsMCwwLDApKSB9CiAgICAuaWIgeyB3aWR0aDogNDJweDsgaGVpZ2h0OiA0MnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGRpc3BsYXk6IGdyaWQ7IHBsYWNlLWl0ZW1zOiBjZW50ZXI7IGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdykgfQogICAgLmliLmZ4LXRyYW5zOmhvdmVyIHsgYm94LXNoYWRvdzogMCAxMHB4IDI4cHggcmdiYSgwLDAsMCwuNSksIDAgMCAwIDJweCByZ2JhKDI1NSwyNTUsMjU1LC4xMCkgaW5zZXQgfQogICAgLnRpdGxlIHsgZmxleDogMTsgdGV4dC1hbGlnbjogY2VudGVyOyBsaW5lLWhlaWdodDogMSB9CiAgICAudGl0bGUgaDEgeyBtYXJnaW46IDA7IGZvbnQtc2l6ZTogMThweDsgbGV0dGVyLXNwYWNpbmc6IC4wNmVtOyBmb250LXdlaWdodDogOTAwIH0KICAgIC50aXRsZSBzbWFsbCB7IGRpc3BsYXk6IGJsb2NrOyBjb2xvcjogdmFyKC0tbXV0KTsgbGV0dGVyLXNwYWNpbmc6IC4xZW0gfQoKICAgIC8qID09PT09IExheW91dCA9PT09PSAqLwogICAgbWFpbiB7IHBvc2l0aW9uOiByZWxhdGl2ZTsgaGVpZ2h0OiAxMDAlOyBwYWRkaW5nLXRvcDogY2FsYyh2YXIoLS1oZHJIKSArIGVudihzYWZlLWFyZWEtaW5zZXQtdG9wKSk7IHBhZGRpbmctYm90dG9tOiBjYWxjKHZhcigtLXRhYnNIKSArIGVudihzYWZlLWFyZWEtaW5zZXQtYm90dG9tKSk7IG92ZXJmbG93OiBoaWRkZW4gfQogICAgLnZpZXcgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGluc2V0OiAwOyBwYWRkaW5nOiAxMnB4IDE0cHg7IG92ZXJmbG93OiBhdXRvOyBkaXNwbGF5OiBub25lIH0KICAgIC52aWV3LmFjdGl2ZSB7IGRpc3BsYXk6IGJsb2NrOyBhbmltYXRpb246IGZhZGUgLjE4cyB2YXIoLS1lYXNlKSB9CiAgICBAa2V5ZnJhbWVzIGZhZGUgeyBmcm9tIHsgb3BhY2l0eTogMDsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDZweCkgfSB9CgogICAgLyogPT09PT0gQ2FyZHMgLyBncmlkcyA9PT09PSAqLwogICAgLmdyaWQgeyBkaXNwbGF5OiBncmlkOyBnYXA6IDEycHg7IG1heC13aWR0aDogODIwcHg7IG1hcmdpbjogMCBhdXRvIH0KICAgIC8qIERpc3RyaWJ1YSBvcyBjYXJ0w7VlcyBkZSBzdGF0dXMgZGEgSG9tZSBlbSBkdWFzIGNvbHVuYXMgcGFyYSBtZWxob3IgZW5jYWl4ZS4KICAgICAgIEVtIHRlbGFzIGVzdHJlaXRhcyAoPDU2MHB4KSBlbGVzIHNlIGVtcGlsaGFtIGVtIHVtYSDDum5pY2EgY29sdW5hLiAqLwogICAgLmNhcmRzIHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMiwgbWlubWF4KDAsIDFmcikpOyBnYXA6IDEycHggfQogICAgQG1lZGlhIChtYXgtd2lkdGg6IDU2MHB4KSB7IC5jYXJkcyB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIH0gfQoKICAgIC8qIE9jdWx0YXIgbyBtZW51IGRlIG9ww6fDtWVzIChBcHBzLCBTdGFjaywgQnJhaW4sIFJldm8pIG5hIEhvbWUgcXVhbmRvIGFwZW5hcyBhIGJvbGEgZG9zIGFycXXDqXRpcG9zIGRldmUgYXBhcmVjZXIgKi8KICAgIC8qIEhpZGUgdGhlIFVOTyBpbmZvIGNhcmQgb24gaG9tZS4gVGhlIGNhcmRzIHJvdyBpcyBub3cgdXNlZCBmb3Igc3RhdHVzIG5vdGlmaWNhdGlvbnMgKi8KICAgICN2LWhvbWUgI3Vub0NhcmQgewogICAgICBkaXNwbGF5OiBub25lOwogICAgfQoKICAgIC8qID09PT09IEFwcHMgUGFnZSBjdXN0b21pemF0aW9ucyA9PT09PSAqLwogICAgLyogRXN0aWxpemFyIGJvdMOjbyBkZSB1cGxvYWQgZGUgSFRNTCBsb2NhbCBwYXJhIGRlc3RhcXVlICovCiAgICAjYnRuSW1wb3J0IHsKICAgICAgZm9udC13ZWlnaHQ6IDcwMDsKICAgICAgY29sb3I6IHZhcigtLWluayk7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzKTsKICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1saW5lKTsKICAgIH0KICAgIC8qIEZhdm9yaXRlIGljb24vYnV0dG9uIGRlbnRybyBkZSBjYWRhIGNhcnTDo28gZGUgYXBwICovCiAgICAuYXBwLWNhcmQgewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB9CiAgICAuZmF2LWJ0biB7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgdG9wOiA2cHg7CiAgICAgIHJpZ2h0OiA2cHg7CiAgICAgIHdpZHRoOiAyMnB4OwogICAgICBoZWlnaHQ6IDIycHg7CiAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIHBhZGRpbmc6IDA7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgb3BhY2l0eTogMC42OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgei1pbmRleDogMjsKICAgIH0KICAgIC5mYXYtYnRuLmZhdiB7CiAgICAgIG9wYWNpdHk6IDE7CiAgICB9CiAgICAuZmF2LWJ0biBpbWcgewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAvKiDDjWNvbmVzIG7Do28gZmF2b3JpdGFkb3MgZmljYW0gZW0gdG9ucyBkZSBjaW56YSBwYXJhIGluZGljYXIgZXN0YWRvIG9mZiAqLwogICAgICBmaWx0ZXI6IGdyYXlzY2FsZSgxKSBicmlnaHRuZXNzKDAuNSk7CiAgICB9CiAgICAuZmF2LWJ0bi5mYXYgaW1nIHsKICAgICAgLyogw41jb25lIGZhdm9yaXRhZG8gbWFudMOpbSBjb3Igb3JpZ2luYWwgKGFtYXJlbG8pICovCiAgICAgIGZpbHRlcjogbm9uZTsKICAgIH0KICAgIC5jYXJkIHsgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZSk7IGJvcmRlcjogdmFyKC0tYmQpOyBib3JkZXItcmFkaXVzOiB2YXIoLS1yMik7IGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdyk7IHBhZGRpbmc6IDEycHg7IGRpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcG9zaXRpb246IHJlbGF0aXZlIH0KICAgIC5jYXJkLmZ4LXRyYW5zOmhvdmVyIHsgYm94LXNoYWRvdzogMCAxNnB4IDQwcHggcmdiYSgwLDAsMCwuNSkgfQogICAgLmljbyB7IHdpZHRoOiA0NHB4OyBoZWlnaHQ6IDQ0cHg7IGJvcmRlci1yYWRpdXM6IDE0cHg7IGRpc3BsYXk6IGdyaWQ7IHBsYWNlLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsLjA2KTsgYm9yZGVyOiB2YXIoLS1iZCkgfQogICAgLm11dCB7IGNvbG9yOiB2YXIoLS1tdXQpOyBmb250LXNpemU6IDEycHggfQogICAgLmlucHV0LCBzZWxlY3QsIHRleHRhcmVhIHsgd2lkdGg6IDEwMCU7IGJhY2tncm91bmQ6ICMwZjE0MjY7IGNvbG9yOiB2YXIoLS1mZyk7IGJvcmRlcjogdmFyKC0tYmQpOyBib3JkZXItcmFkaXVzOiAxMnB4OyBwYWRkaW5nOiAxMHB4IH0KCiAgICAvKiBBanVzdGUgcGFyYSDDrWNvbmVzIFNWRyBleHRlcm5vczogaW52ZXJ0w6otbG9zIHBhcmEgcXVlIGZpcXVlbSBjbGFyb3MgZW0gdGVtYXMgZXNjdXJvcyAqLwogICAgaGVhZGVyLm1hc3QgaW1nLAogICAgLnRhYmJhciBpbWcsCiAgICAuY2FyZCAuaWNvIGltZywKICAgIC5zZXNzaW9uIC50b29scyBpbWcsCiAgICAuZG9jayBpbWcgewogICAgICBmaWx0ZXI6IGludmVydCgxKSBicmlnaHRuZXNzKDEuMik7CiAgICB9CgogICAgLyogPT09PT0gQXBwcyA9PT09PSAqLwogICAgLmFwcHMtd3JhcCB7IGRpc3BsYXk6IGdyaWQ7IGdhcDogMTJweCB9CiAgICAuYXBwLWNhcmQgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEycHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UpOyBib3JkZXI6IHZhcigtLWJkKTsgYm9yZGVyLXJhZGl1czogdmFyKC0tcik7IHBhZGRpbmc6IDEycHggfQogICAgLmFwcC1jYXJkOmhvdmVyIHsgYm94LXNoYWRvdzogMCAxMnB4IDM0cHggcmdiYSgwLDAsMCwuNDYpIH0KICAgIC5hcHAtaWNvbiB7IHdpZHRoOiA0MnB4OyBoZWlnaHQ6IDQycHg7IGJvcmRlci1yYWRpdXM6IDEycHg7IGRpc3BsYXk6IGdyaWQ7IHBsYWNlLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQ6ICMwZjE1Mjg7IGJvcmRlcjogdmFyKC0tYmQpOyBvdmVyZmxvdzogaGlkZGVuIH0KICAgIC5hcHAtdGl0bGUgeyBmb250LXdlaWdodDogODAwIH0KCiAgICAvKiA9PT09PSBWaWV3ZXIgKFN0YWNrKSA9PT09PSAqLwogICAgLnNlc3Npb24geyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCByZ2JhKDI1NSwyNTUsMjU1LC4wNSksIHJnYmEoMjU1LDI1NSwyNTUsLjAyKSk7IGJvcmRlcjogdmFyKC0tYmQpOyBib3JkZXItcmFkaXVzOiAxNnB4OyBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOyBvdmVyZmxvdzogaGlkZGVuIH0KICAgIC5zZXNzaW9uIC5oZHIgeyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsgcGFkZGluZzogMTBweDsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE4MGRlZywgcmdiYSgyNTUsMjU1LDI1NSwuMDYpLCByZ2JhKDI1NSwyNTUsMjU1LC4wMikpOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2ZmZmZmZjE4IH0KICAgIC5zZXNzaW9uIC50aXRsZSB7IGZvbnQtd2VpZ2h0OiA4NTA7IG1heC13aWR0aDogNTZ2dzsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3c6IGhpZGRlbjsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXMgfQogICAgLnNlc3Npb24gLnRvb2xzIHsgbWFyZ2luLWxlZnQ6IGF1dG87IGRpc3BsYXk6IGZsZXg7IGdhcDogNnB4IH0KICAgIC5zZXNzaW9uIC50b29scyAuYnRuOmhvdmVyIHsgYm94LXNoYWRvdzogMCAwIDAgMXB4IHJnYmEoMjU1LDI1NSwyNTUsLjE4KSBpbnNldCwgMCA4cHggMjJweCByZ2JhKDAsMCwwLC4zNSkgfQogICAgLnNlc3Npb24gaWZyYW1lIHsgZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDYwdmg7IGJvcmRlcjogMDsgYmFja2dyb3VuZDogIzAwMCB9CiAgICAuc2Vzc2lvbi5taW4gaWZyYW1lIHsgZGlzcGxheTogbm9uZSB9CgogICAgLyogPT09PT0gRG9jayArIFRhYnMgPT09PT0gKi8KICAgIC5kb2NrIHsgcG9zaXRpb246IGZpeGVkOyBsZWZ0OiAxMHB4OyByaWdodDogMTBweDsgYm90dG9tOiBjYWxjKHZhcigtLXRhYnNIKSArIDhweCArIGVudihzYWZlLWFyZWEtaW5zZXQtYm90dG9tKSk7IGRpc3BsYXk6IGZsZXg7IGdhcDogOHB4OyBmbGV4LXdyYXA6IHdyYXA7IHotaW5kZXg6IDgwIH0KICAgIC5iYWRnZSB7IGRpc3BsYXk6IGlubGluZS1mbGV4OyBnYXA6IDZweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZzogLjM4cmVtIC42NXJlbTsgYm9yZGVyOiAxcHggc29saWQgI2ZmZmZmZjE4OyBiYWNrZ3JvdW5kOiAjMGYxNDI4OyBib3JkZXItcmFkaXVzOiA5OTlweDsgZm9udC13ZWlnaHQ6IDgwMDsgcG9zaXRpb246IHJlbGF0aXZlIH0KICAgIC5iYWRnZS5meC10cmFuczpob3ZlciB7IGJveC1zaGFkb3c6IDAgMTBweCAyNHB4IHJnYmEoMCwwLDAsLjUpIH0KICAgIG5hdi50YWJiYXIgeyBwb3NpdGlvbjogZml4ZWQ7IGxlZnQ6IDA7IHJpZ2h0OiAwOyBib3R0b206IGVudihzYWZlLWFyZWEtaW5zZXQtYm90dG9tLCAwKTsgaGVpZ2h0OiB2YXIoLS10YWJzSCk7IHotaW5kZXg6IDkwOyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgcGFkZGluZzogNnB4IDE0cHggfQogICAgLnRhYmJhciAuaW5uZXIgeyB3aWR0aDogMTAwJTsgbWF4LXdpZHRoOiA4MjBweDsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UpOyBib3JkZXI6IHZhcigtLWJkKTsgYm9yZGVyLXJhZGl1czogMjJweDsgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93KTsgcGFkZGluZzogMTBweCAxNHB4IH0KICAgIC50YWIgeyBmbGV4OiAxOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsgY29sb3I6IHZhcigtLW11dCk7IGZvbnQtc2l6ZTogMTFweDsgZm9udC13ZWlnaHQ6IDgwMDsgcGFkZGluZzogOHB4OyBib3JkZXItcmFkaXVzOiAxNHB4OyBjdXJzb3I6IHBvaW50ZXI7IHBvc2l0aW9uOiByZWxhdGl2ZSB9CiAgICAudGFiLmZ4LXRyYW5zOmhvdmVyIHsgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwuMDYpIH0KICAgIC50YWIuYWN0aXZlIHsgY29sb3I6IHZhcigtLWZnKTsgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwuMTApOyBib3gtc2hhZG93OiAwIDAgMCAycHggcmdiYSgyNTUsMjU1LDI1NSwuMTApIH0KCiAgICAvKiA9PT0gw4FyZWEgZGUgQXJxdcOpdGlwb3MgKGNlbnRyYWwgY2lyY2xlKSA9PT0gKi8KICAgIC5hcmNoLWNvbnRhaW5lciB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBtYXJnaW4tdG9wOiAyNHB4OwogICAgfQogICAgLmFyY2gtY2lyY2xlIHsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICB3aWR0aDogbWluKDgwdncsIDU2MHB4KTsKICAgICAgYXNwZWN0LXJhdGlvOiAxIC8gMTsKICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMTIpOwogICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoNjAlIDYwJSBhdCA1MCUgNTAlLCByZ2JhKDAsMjU1LDI1NSwuMSksIHJnYmEoMjU1LDI1NSwyNTUsLjAyKSk7CiAgICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdywgMCAxNHB4IDQwcHggcmdiYSgwLDAsMCwuNDUpKTsKICAgIH0KICAgIC5hcmNoLWNpcmNsZSBpZnJhbWUgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIGluc2V0OiAwOwogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBib3JkZXI6IDA7CiAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgfQogICAgLmFyY2gtc3dpdGNoZXIgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMTBweDsKICAgICAgbGVmdDogNTAlOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogNnB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE1LDE3LDMyLC43KTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpOwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig4cHgpOwogICAgfQogICAgLmFyY2gtc3dpdGNoZXIgc2VsZWN0IHsKICAgICAgYXBwZWFyYW5jZTogbm9uZTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwuMDYpOwogICAgICBjb2xvcjogdmFyKC0tZmcpOwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4xMik7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBwYWRkaW5nOiA2cHggMTBweDsKICAgIH0KICAgIC5hcmNoLWRvdGxvZ28gewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMTJweDsKICAgICAgcmlnaHQ6IDEycHg7CiAgICAgIHdpZHRoOiAxOHB4OwogICAgICBoZWlnaHQ6IDE4cHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgYmFja2dyb3VuZDogY29uaWMtZ3JhZGllbnQoIzAwYzVlNSwgI2ZmNTJlNSwgIzAwYzVlNSk7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAxOHB4IHJnYmEoMCwyNTUsMjU1LC40KTsKICAgIH0KICAgICNhcmNoLWZhZGVDb3ZlciB7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgaW5zZXQ6IDA7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLCAjMGIwZjE0KTsKICAgICAgb3BhY2l0eTogMDsKICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgLjNzIGVhc2U7CiAgICB9CiAgICAjYXJjaC1mYWRlQ292ZXIuc2hvdyB7IG9wYWNpdHk6IDE7IH0KCiAgICAvKiA9PT09PSBNb2RhbCA9PT09PSAqLwogICAgLm1vZGFsIHsgcG9zaXRpb246IGZpeGVkOyBpbnNldDogMDsgZGlzcGxheTogbm9uZTsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IHotaW5kZXg6IDEyMDsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuNDUpOyBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNnB4KSB9CiAgICAubW9kYWwub3BlbiB7IGRpc3BsYXk6IGZsZXggfQogICAgLm1vZGFsIC5wYW5lbCB7IHdpZHRoOiBtaW4oNzIwcHgsIDkydncpOyBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLXN0cm9uZyk7IGJvcmRlcjogdmFyKC0tYmQpOyBib3JkZXItcmFkaXVzOiAxNnB4OyBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOyBwYWRkaW5nOiAxNnB4IH0KICAgIC5rYmQgeyBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4yKTsgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwuMDYpOyBwYWRkaW5nOiAycHggNnB4OyBib3JkZXItcmFkaXVzOiA2cHg7IGZvbnQtZmFtaWx5OiB1aS1tb25vc3BhY2UsIE1lbmxvLCBDb25zb2xhcywgbW9ub3NwYWNlOyBmb250LXNpemU6IDEycHggfQoKICAgIC8qID09PT09IFJFVk8gdmlldyBzdHlsaW5nID09PT09ICovCiAgICAvKiBSZW1vdmUgZGVmYXVsdCBwYWRkaW5nIGZvciB0aGUgbmV3IFJldm8gc2VjdGlvbiBhbmQgZW5zdXJlIHRoZSBpZnJhbWUgZmlsbHMgdGhlIHNwYWNlICovCiAgICAjdi1yZXZvIHsgcGFkZGluZzogMDsgfQogICAgI3YtcmV2byBpZnJhbWUgeyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBib3JkZXI6IDA7IGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyB9CiAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICA8IS0tID09PT09IEhlYWRlciA9PT09PSAtLT4KICA8aGVhZGVyIGNsYXNzPSJtYXN0Ij4KICAgIDxidXR0b24gY2xhc3M9ImliIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGlkPSJidG5CYWNrIiB0aXRsZT0iVm9sdGFyIiBhcmlhLWxhYmVsPSJWb2x0YXIiPgogICAgPGltZyBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vQGZvcnRhd2Vzb21lL2ZvbnRhd2Vzb21lLWZyZWVANi9zdmdzL3NvbGlkL2Fycm93LWxlZnQuc3ZnIiBhbHQ9IlZvbHRhciIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBvbmVycm9yPSJ0aGlzLm9uZXJyb3I9bnVsbDt0aGlzLnNyYz0naWNvbnMvYXJyb3ctbGVmdC5zdmcnIj4KICAgICAgPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgPC9idXR0b24+CiAgICA8ZGl2IGNsYXNzPSJ0aXRsZSI+CiAgICAgIDxoMT5IVUIgVU5PIOKAlCBNb27Ds2xpdG8gKyBSZXZvPC9oMT4KICAgICAgPHNtYWxsPkR1YWwgwrcgVHJpbml0eSDCtyBNaW5pbWFsIMK3IFVsdHJhPC9zbWFsbD4KICAgIDwvZGl2PgogICAgPGJ1dHRvbiBjbGFzcz0iaWIgZngtdHJhbnMgZngtcHJlc3MgcmluZyIgaWQ9ImJ0bkRvd25sb2FkIiB0aXRsZT0iQmFpeGFyIEhUTUwiPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvZG93bmxvYWQuc3ZnIiBhbHQ9IkRvd25sb2FkIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIG9uZXJyb3I9InRoaXMub25lcnJvcj1udWxsO3RoaXMuc3JjPSdpY29ucy9kb3dubG9hZC5zdmcnIj4KICAgICAgPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgPC9idXR0b24+CiAgICA8YnV0dG9uIGNsYXNzPSJpYiBmeC10cmFucyBmeC1wcmVzcyByaW5nIiBpZD0iYnRuSGVscCIgdGl0bGU9IkFqdWRhIC8gQXRhbGhvcyI+CjxpbWcgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlQDYvc3Zncy9zb2xpZC9xdWVzdGlvbi1jaXJjbGUuc3ZnIiBhbHQ9IkFqdWRhIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIG9uZXJyb3I9InRoaXMub25lcnJvcj1udWxsO3RoaXMuc3JjPSdpY29ucy9xdWVzdGlvbi1jaXJjbGUuc3ZnJyI+CiAgICAgIDxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj4KICAgIDwvYnV0dG9uPgogICAgPGJ1dHRvbiBjbGFzcz0iaWIgZngtdHJhbnMgZngtcHJlc3MgcmluZyIgaWQ9ImJ0bkJyYWluIiB0aXRsZT0iQnJhaW4iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvYnJhaW4uc3ZnIiBhbHQ9IkJyYWluIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIG9uZXJyb3I9InRoaXMub25lcnJvcj1udWxsO3RoaXMuc3JjPSdpY29ucy9icmFpbi5zdmcnIj4KICAgICAgPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgPC9idXR0b24+CiAgPC9oZWFkZXI+CgogIDwhLS0gQ29udGFpbmVyIHBhcmEgZnVuZG8gcGVyc29uYWxpemFkbyAoaW1hZ2VtIG91IHbDrWRlbykuICBTZXLDoSBwcmVlbmNoaWRvIHZpYSBKUyBxdWFuZG8gbyB1c3XDoXJpbyBlc2NvbGhlcgogICAgICAgdW0gdGVtYSBjdXN0b21pemFkby4gIEZpY2Egbm8gaW7DrWNpbyBkbyBib2R5IHBhcmEgZ2FyYW50aXIgcXVlIGZpcXVlIGFiYWl4byBkZSB0b2RvcyBvcyBjb250ZcO6ZG9zIC0tPgogIDxkaXYgaWQ9ImN1c3RvbS1iZyIgc3R5bGU9InBvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3otaW5kZXg6LTE7b3ZlcmZsb3c6aGlkZGVuO3BvaW50ZXItZXZlbnRzOm5vbmUiPjwvZGl2PgoKICA8IS0tID09PT09IFZpZXdzID09PT09IC0tPgogIDxtYWluPgogICAgPCEtLSBIT01FIC0tPgogICAgPHNlY3Rpb24gaWQ9InYtaG9tZSIgY2xhc3M9InZpZXcgYWN0aXZlIj4KICAgICAgPGRpdiBjbGFzcz0iZ3JpZCI+CiAgICAgICAgICA8IS0tIFNhdWRhw6fDo28gLyBjaGFtYWRhIHBhcmEgY2FkYXN0cm8uIFZpc8OtdmVsIHF1YW5kbyBvIHVzdcOhcmlvIHByZWNpc2EgYXRpdmFyIGEgRHVhbCBJbmZvZG9zZSBvdSBxdWFuZG8gasOhIGhvdXZlciBub21lIHNhbHZvIC0tPgogICAgICAgICAgPGRpdiBpZD0iZ3JlZXRpbmdDYXJkIiBjbGFzcz0iY2FyZCBmeC10cmFucyBmeC1saWZ0IiBzdHlsZT0iZGlzcGxheTpub25lIj4KICAgICAgICAgICAgPGRpdiBpZD0iZ3JlZXRpbmdNc2ciIHN0eWxlPSJmb250LXdlaWdodDo4MDAiPjwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0idW5vQ2FyZCIgY2xhc3M9ImNhcmQgZngtdHJhbnMgZngtbGlmdCIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3dpZHRoOjEwMCUiPgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjkwMDtsZXR0ZXItc3BhY2luZzouMDhlbSI+VU5PIOKAoiBmb2NvIGUgdmVsb2NpZGFkZTwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11dCI+TW9uw7NsaXRvOiBBcHBzIGVtYnV0aWRvcyArIFZpZXdlciArIERvY2sgKyBBdGFsaG9zPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpY28iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvYm9sdC5zdmciIGFsdD0iRW5lcmdpYSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBvbmVycm9yPSJ0aGlzLm9uZXJyb3I9bnVsbDt0aGlzLnNyYz0naWNvbnMvYm9sdC5zdmcnIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8IS0tIMOBcmVhIGRlIEFycXXDqXRpcG9zIGluY29ycG9yYWRhIC0tPgogICAgICAgIDxkaXYgY2xhc3M9ImFyY2gtY29udGFpbmVyIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImFyY2gtY2lyY2xlIj4KICAgICAgICAgICAgPGRpdiBpZD0iYXJjaC1mYWRlQ292ZXIiPjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcmNoLWRvdGxvZ28iIHRpdGxlPSJhcnF1w6l0aXBvIGF0aXZvIj48L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXJjaC1zd2l0Y2hlciI+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGlkPSJhcmNoLXByZXYiIHRpdGxlPSJBbnRlcmlvciI+CiAgICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvY2hldnJvbi1sZWZ0LnN2ZyIgYWx0PSJBbnRlcmlvciIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBvbmVycm9yPSJ0aGlzLm9uZXJyb3I9bnVsbDt0aGlzLnNyYz0naWNvbnMvY2hldnJvbi1sZWZ0LnN2ZyciPgogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImFyY2gtc2VsZWN0IiB0aXRsZT0iRXNjb2xoZXIgYXJxdcOpdGlwbyI+PC9zZWxlY3Q+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGlkPSJhcmNoLW5leHQiIHRpdGxlPSJQcsOzeGltbyI+CiAgICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvY2hldnJvbi1yaWdodC5zdmciIGFsdD0iUHLDs3hpbW8iIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL2NoZXZyb24tcmlnaHQuc3ZnJyI+CiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8aWZyYW1lIGlkPSJhcmNoLWZyYW1lIiB0aXRsZT0iQXJjaGV0eXBlIENvcmUiIHNhbmRib3g9ImFsbG93LXNjcmlwdHMiIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciI+PC9pZnJhbWU+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkcyI+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjYXJkIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGRhdGEtbmF2PSJhcHBzIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iaWNvIj4KPGltZyBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vQGZvcnRhd2Vzb21lL2ZvbnRhd2Vzb21lLWZyZWVANi9zdmdzL3NvbGlkL2ZvbGRlci1vcGVuLnN2ZyIgYWx0PSJBcHBzIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIG9uZXJyb3I9InRoaXMub25lcnJvcj1udWxsO3RoaXMuc3JjPSdpY29ucy9mb2xkZXItb3Blbi5zdmcnIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC13ZWlnaHQ6ODAwIj5BcHBzPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXV0IiBpZD0iaG9tZUFwcHNTdGF0dXMiPuKAkzwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjYXJkIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGRhdGEtbmF2PSJzdGFjayI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImljbyI+CjxpbWcgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlQDYvc3Zncy9zb2xpZC9sYXllci1ncm91cC5zdmciIGFsdD0iU3RhY2siIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL2xheWVyLWdyb3VwLnN2ZyciPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo4MDAiPlN0YWNrPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXV0IiBpZD0iaG9tZVN0YWNrU3RhdHVzIj7igJM8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj4KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2FyZCBmeC10cmFucyBmeC1wcmVzcyByaW5nIiBkYXRhLW5hdj0iYnJhaW4iPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpY28iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvdXNlci5zdmciIGFsdD0iVXN1w6FyaW8iIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL3VzZXIuc3ZnJyI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjgwMCI+VXN1w6FyaW88L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXQiIGlkPSJob21lVXNlclN0YXR1cyI+4oCTPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNhcmQgZngtdHJhbnMgZngtcHJlc3MgcmluZyIgZGF0YS1uYXY9ImhvbWUiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpY28iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQveWluLXlhbmcuc3ZnIiBhbHQ9IkFycXXDqXRpcG8iIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL3lpbi15YW5nLnN2ZyciPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo4MDAiPkFycXXDqXRpcG88L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXQiIGlkPSJob21lQXJjaFN0YXR1cyI+4oCTPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L3NlY3Rpb24+CgogICAgPCEtLSBBUFBTIC0tPgogICAgPHNlY3Rpb24gaWQ9InYtYXBwcyIgY2xhc3M9InZpZXciPgogICAgICA8ZGl2IGNsYXNzPSJncmlkIj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIGZ4LXRyYW5zIGZ4LWxpZnQiIHN0eWxlPSJkaXNwbGF5OmJsb2NrIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQiIHN0eWxlPSJnYXA6OHB4Ij4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyIj4KICAgICAgICAgICAgICA8IS0tIFJlbW92ZW1vcyBhIGJ1c2NhIGUgbyBzb3J0LiBBZ29yYSBhcGVuYXMgYSBvcMOnw6NvIGRlIGFicmlyIGRlbnRybyBlIG8gYm90w6NvIHBhcmEgbW9zdHJhciBsb2NhaXMgLS0+CiAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJtdXQiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1mbGV4O2dhcDo2cHg7YWxpZ24taXRlbXM6Y2VudGVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCBpZD0ib3Blbkluc2lkZSIgdHlwZT0iY2hlY2tib3giIGNoZWNrZWQgLz4gYWJyaXIgZGVudHJvCiAgICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG5Ub2dnbGVMb2NhbCIgY2xhc3M9ImJ0biBmeC10cmFucyBmeC1wcmVzcyByaW5nIj5Nb3N0cmFyIExvY2FpczxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4O2ZsZXgtd3JhcDp3cmFwO2FsaWduLWl0ZW1zOmNlbnRlciI+CiAgICAgICAgICAgICAgPGlucHV0IGlkPSJmaWxlTG9jYWwiIHR5cGU9ImZpbGUiIGFjY2VwdD0iLmh0bWwsLmh0bSwudHh0IiBtdWx0aXBsZSBjbGFzcz0iaW5wdXQgcmluZyIgLz4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG5JbXBvcnQiIGNsYXNzPSJidG4gZngtdHJhbnMgZngtcHJlc3MgcmluZyI+QWRpY2lvbmFyIExvY2FpczxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG5FeHBvcnQiIGNsYXNzPSJidG4gZngtdHJhbnMgZngtcHJlc3MgcmluZyI+RXhwb3J0YXIgTG9jYWlzPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gaWQ9ImJ0bkNsZWFyIiBjbGFzcz0iYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciPkxpbXBhciBMb2NhaXM8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJhcHBzQ291bnQiIGNsYXNzPSJtdXQiPuKAlDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0iYXBwc1dyYXAiIGNsYXNzPSJhcHBzLXdyYXAiPjwvZGl2PgogICAgICA8L2Rpdj4KICAgIDwvc2VjdGlvbj4KCiAgICA8IS0tIFNUQUNLIC0tPgogICAgPHNlY3Rpb24gaWQ9InYtc3RhY2siIGNsYXNzPSJ2aWV3Ij4KICAgICAgPGRpdiBjbGFzcz0iZ3JpZCI+CiAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCBmeC10cmFucyBmeC1saWZ0IiBzdHlsZT0iZGlzcGxheTpibG9jayI+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo4MDA7IGRpc3BsYXk6ZmxleDsgYWxpZ24taXRlbXM6Y2VudGVyOyBnYXA6OHB4Ij4KICAgICAgICAgICAgU2Vzc8O1ZXMKICAgICAgICAgICAgPGJ1dHRvbiBpZD0iYnRuQ2xvc2VBbGwiIGNsYXNzPSJidG4gZngtdHJhbnMgZngtcHJlc3MgcmluZyIgdGl0bGU9IkZlY2hhciB0b2RhcyI+RmVjaGFyIHRvZGFzPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXQiPlJlYWJyYSByw6FwaWRvIHBlbG8gZG9jayBhYmFpeG8uPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0ic3RhY2tXcmFwIiBjbGFzcz0iZ3JpZCI+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9zZWN0aW9uPgoKICAgIDwhLS0gQlJBSU4gLS0+CiAgICA8c2VjdGlvbiBpZD0idi1icmFpbiIgY2xhc3M9InZpZXciPgogICAgICA8ZGl2IGNsYXNzPSJncmlkIj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIGZ4LXRyYW5zIGZ4LWxpZnQiIHN0eWxlPSJkaXNwbGF5OmJsb2NrIj4KICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjgwMCI+VXN1w6FyaW88L2Rpdj4KICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tdG9wOjZweCI+CiAgICAgICAgICAgIDxpbnB1dCBpZD0idXNlck5hbWUiIGNsYXNzPSJpbnB1dCByaW5nIiBwbGFjZWhvbGRlcj0iU2V1IG5vbWUiIC8+CiAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmVOYW1lIiBjbGFzcz0iYnRuIHByaW1lIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciPlNhbHZhcjxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImNhcmQgZngtdHJhbnMgZngtbGlmdCIgc3R5bGU9ImRpc3BsYXk6YmxvY2siPgogICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC13ZWlnaHQ6ODAwIj5PcGVuUm91dGVyPC9kaXY+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLXRvcDo2cHg7ZmxleC13cmFwOndyYXAiPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJtb2RlbCIgY2xhc3M9ImlucHV0IHJpbmciIHN0eWxlPSJtYXgtd2lkdGg6MjYwcHgiPjwvc2VsZWN0PgogICAgICAgICAgICA8aW5wdXQgaWQ9InNrIiBjbGFzcz0iaW5wdXQgcmluZyIgcGxhY2Vob2xkZXI9InNrLW9yLXYxLeKApiIgLz4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZVNLIiBjbGFzcz0iYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciPlNhbHZhcjxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICAgIDwhLS0gVGVtYSBlIEZ1bmRvIHBlcnNvbmFsaXphZG9zIC0tPgogICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCBmeC10cmFucyBmeC1saWZ0IiBzdHlsZT0iZGlzcGxheTpibG9jayI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjgwMCI+VGVtYSAmYW1wOyBGdW5kbzwvZGl2PgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjhweDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxMnB4Ij4KICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweCI+CiAgICAgICAgICAgICAgICA8c3Bhbj5Fc2NvbGhhIG8gdGVtYTo8L3NwYW4+CiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJ0aGVtZVNlbGVjdCIgY2xhc3M9ImlucHV0IHJpbmciIHN0eWxlPSJtYXgtd2lkdGg6MjAwcHgiPgogICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJkZWZhdWx0Ij5QYWRyw6NvIChjb2xvcmlkbyk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibWVkaXVtIj5DaW56YSBtw6lkaW8gKHRlY25vbMOzZ2ljbyk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY3VzdG9tIj5QZXJzb25hbGl6YWRvIChzdWEgaW1hZ2VtL3bDrWRlbyk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgICAgPGxhYmVsIHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHgiPgogICAgICAgICAgICAgICAgPHNwYW4+RnVuZG8gcGVyc29uYWxpemFkbzo8L3NwYW4+CiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9ImJnVXBsb2FkIiB0eXBlPSJmaWxlIiBhY2NlcHQ9ImltYWdlLyosdmlkZW8vKiIgY2xhc3M9ImlucHV0IHJpbmciIHN0eWxlPSJtYXgtd2lkdGg6MjYwcHgiIC8+CiAgICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXQiIHN0eWxlPSJmb250LXNpemU6MTFweCI+RW52aWUgdW1hIGltYWdlbSBvdSB2w61kZW8gcGFyYSB1c2FyIGNvbW8gcGxhbm8gZGUgZnVuZG8gcXVhbmRvIG8gdGVtYSBwZXJzb25hbGl6YWRvIGVzdGl2ZXIgc2VsZWNpb25hZG8uIE8gZnVuZG8gc2Vyw6Egc2Fsdm8gYXV0b21hdGljYW1lbnRlIG5vIHNldSBuYXZlZ2Fkb3IuPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPCEtLSBDU1MgcGVyc29uYWxpemFkbyAtLT4KICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQgZngtdHJhbnMgZngtbGlmdCIgc3R5bGU9ImRpc3BsYXk6YmxvY2siPgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo4MDAiPkNTUyBQZXJzb25hbGl6YWRvPC9kaXY+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6OHB4Ij4KICAgICAgICAgICAgICA8dGV4dGFyZWEgaWQ9ImNzc0N1c3RvbSIgY2xhc3M9ImlucHV0IHJpbmciIHBsYWNlaG9sZGVyPSJDU1MgcGVyc29uYWxpemFkby4uLiIgcm93cz0iNCI+PC90ZXh0YXJlYT4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjZweDsgZGlzcGxheTpmbGV4OyBnYXA6OHB4OyBmbGV4LXdyYXA6d3JhcCI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJhcHBseUNTUyIgY2xhc3M9ImJ0biBmeC10cmFucyBmeC1wcmVzcyByaW5nIj5BcGxpY2FyIENTUzxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImNsZWFyQ1NTIiBjbGFzcz0iYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciPkxpbXBhciBDU1M8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+PC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJkb3dubG9hZENTUyIgY2xhc3M9ImJ0biBmeC10cmFucyBmeC1wcmVzcyByaW5nIj5CYWl4YXIgQ1NTPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPjwvYnV0dG9uPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgIDwhLS0gVm96ZXMgZG9zIEFycXXDqXRpcG9zIC0tPgogICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCBmeC10cmFucyBmeC1saWZ0IiBzdHlsZT0iZGlzcGxheTpibG9jayI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjgwMDsgbWFyZ2luLWJvdHRvbTo2cHgiPlZvemVzIGRvcyBBcnF1w6l0aXBvczwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJ2b2ljZXNXcmFwIiBzdHlsZT0iZGlzcGxheTpncmlkOyBnYXA6MTBweCI+PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L3NlY3Rpb24+CgogICAgPCEtLSBSRVZPIChJbmZvZG9zZSBIdWIgVWx0cmEpIC0tPgogICAgPHNlY3Rpb24gaWQ9InYtcmV2byIgY2xhc3M9InZpZXciPgogICAgICA8IS0tIENhcnJlZ2EgbyBjb250ZcO6ZG8gZG8gSHViIFVsdHJhIG1vZGlmaWNhZG8gdmlhIGlmcmFtZS4gIE8gYXJxdWl2byBpbmRleC0xMDBfcmV2b19tb2QuaHRtbCBlc3TDoSBubyBtZXNtbyBkaXJldMOzcmlvIC0tPgogICAgICA8aWZyYW1lIGlkPSJyZXZvRW1iZWQiIHNyYz0iaW5kZXgtMTAwX3Jldm9fbW9kLmh0bWwiIGFsbG93PSJhdXRvcGxheTsgY2xpcGJvYXJkLXJlYWQ7IGNsaXBib2FyZC13cml0ZTsgcGljdHVyZS1pbi1waWN0dXJlOyBmdWxsc2NyZWVuIiByZWZlcnJlcnBvbGljeT0ibm8tcmVmZXJyZXIiPjwvaWZyYW1lPgogICAgPC9zZWN0aW9uPgogIDwvbWFpbj4KCiAgPCEtLSBET0NLICYgVEFCUyAtLT4KICA8ZGl2IGlkPSJkb2NrIiBjbGFzcz0iZG9jayI+PC9kaXY+CiAgPG5hdiBjbGFzcz0idGFiYmFyIj4KICAgIDxkaXYgY2xhc3M9ImlubmVyIj4KICAgICAgPGJ1dHRvbiBjbGFzcz0idGFiIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmcgYWN0aXZlIiBkYXRhLW5hdj0iaG9tZSI+CjxpbWcgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlQDYvc3Zncy9zb2xpZC9ob3VzZS5zdmciIGFsdD0iSG9tZSIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiBvbmVycm9yPSJ0aGlzLm9uZXJyb3I9bnVsbDt0aGlzLnNyYz0naWNvbnMvaG91c2Uuc3ZnJyI+CiAgICAgICAgPHNwYW4gc3R5bGU9ImRpc3BsYXk6bm9uZSI+SG9tZTwvc3Bhbj48c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgIDwvYnV0dG9uPgogICAgICA8YnV0dG9uIGNsYXNzPSJ0YWIgZngtdHJhbnMgZngtcHJlc3MgcmluZyIgZGF0YS1uYXY9ImFwcHMiPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvZm9sZGVyLW9wZW4uc3ZnIiBhbHQ9IkFwcHMiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL2ZvbGRlci1vcGVuLnN2ZyciPgogICAgICAgIDxzcGFuIHN0eWxlPSJkaXNwbGF5Om5vbmUiPkFwcHM8L3NwYW4+PHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgICA8L2J1dHRvbj4KICAgICAgPGJ1dHRvbiBjbGFzcz0idGFiIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmciIGRhdGEtbmF2PSJzdGFjayI+CjxpbWcgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlQDYvc3Zncy9zb2xpZC9sYXllci1ncm91cC5zdmciIGFsdD0iU3RhY2siIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL2xheWVyLWdyb3VwLnN2ZyciPgogICAgICAgIDxzcGFuIHN0eWxlPSJkaXNwbGF5Om5vbmUiPlN0YWNrPC9zcGFuPjxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj4KICAgICAgPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9InRhYiBmeC10cmFucyBmeC1wcmVzcyByaW5nIiBkYXRhLW5hdj0iYnJhaW4iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvYnJhaW4uc3ZnIiBhbHQ9IkJyYWluIiB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIG9uZXJyb3I9InRoaXMub25lcnJvcj1udWxsO3RoaXMuc3JjPSdpY29ucy9icmFpbi5zdmcnIj4KICAgICAgICA8c3BhbiBzdHlsZT0iZGlzcGxheTpub25lIj5CcmFpbjwvc3Bhbj48c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgIDwvYnV0dG9uPgogICAgICA8IS0tIEJvdMOjbyBkYSBub3ZhIGFiYSBSZXZvIC0tPgogICAgICA8YnV0dG9uIGNsYXNzPSJ0YWIgZngtdHJhbnMgZngtcHJlc3MgcmluZyIgZGF0YS1uYXY9InJldm8iPgo8aW1nIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZUA2L3N2Z3Mvc29saWQvZ2xvYmUuc3ZnIiBhbHQ9IlJldm8iIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgb25lcnJvcj0idGhpcy5vbmVycm9yPW51bGw7dGhpcy5zcmM9J2ljb25zL2dsb2JlLnN2ZyciPgogICAgICAgIDxzcGFuIHN0eWxlPSJkaXNwbGF5Om5vbmUiPlJldm88L3NwYW4+PHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPgogICAgICA8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvbmF2PgoKICA8IS0tIEhFTFAgTU9EQUwgLS0+CiAgPGRpdiBpZD0ibW9kYWxIZWxwIiBjbGFzcz0ibW9kYWwiIGFyaWEtaGlkZGVuPSJ0cnVlIj4KICAgIDxkaXYgY2xhc3M9InBhbmVsIj4KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTBweDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbiI+CiAgICAgICAgPGgzIHN0eWxlPSJtYXJnaW46MCI+QWp1ZGEgJiBBdGFsaG9zPC9oMz4KICAgICAgICA8YnV0dG9uIGlkPSJjbG9zZUhlbHAiIGNsYXNzPSJidG4gZngtdHJhbnMgZngtcHJlc3MgcmluZyI+RmVjaGFyPHNwYW4gY2xhc3M9InJpcHBsZSI+PC9zcGFuPjwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ibXV0IiBzdHlsZT0ibWFyZ2luLXRvcDo4cHgiPk5hdmVndWUgbWFpcyByw6FwaWRvOjwvZGl2PgogICAgICA8dWw+CiAgICAgICAgPGxpPjxzcGFuIGNsYXNzPSJrYmQiPmc8L3NwYW4+IHRoZW4gPHNwYW4gY2xhc3M9ImtiZCI+aDwvc3Bhbj4g4oaSIEhvbWU8L2xpPgogICAgICAgIDxsaT48c3BhbiBjbGFzcz0ia2JkIj5nPC9zcGFuPiB0aGVuIDxzcGFuIGNsYXNzPSJrYmQiPmE8L3NwYW4+IOKGkiBBcHBzPC9saT4KICAgICAgICA8bGk+PHNwYW4gY2xhc3M9ImtiZCI+Zzwvc3Bhbj4gdGhlbiA8c3BhbiBjbGFzcz0ia2JkIj5zPC9zcGFuPiDihpIgU3RhY2s8L2xpPgogICAgICAgIDxsaT48c3BhbiBjbGFzcz0ia2JkIj5nPC9zcGFuPiB0aGVuIDxzcGFuIGNsYXNzPSJrYmQiPmI8L3NwYW4+IOKGkiBCcmFpbjwvbGk+CiAgICAgICAgPGxpPjxzcGFuIGNsYXNzPSJrYmQiPmc8L3NwYW4+IHRoZW4gPHNwYW4gY2xhc3M9ImtiZCI+cjwvc3Bhbj4g4oaSIFJldm88L2xpPgogICAgICAgIDxsaT48c3BhbiBjbGFzcz0ia2JkIj5DdHJsIC8gQ21kPC9zcGFuPiArIDxzcGFuIGNsYXNzPSJrYmQiPks8L3NwYW4+IOKGkiBCdXNjYTwvbGk+CiAgICAgICAgPGxpPjxzcGFuIGNsYXNzPSJrYmQiPkN0cmwgLyBDbWQ8L3NwYW4+ICsgPHNwYW4gY2xhc3M9ImtiZCI+Uzwvc3Bhbj4g4oaSIEJhaXhhciBlc3RlIEhUTUw8L2xpPgogICAgICA8L3VsPgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDwhLS0gPT09PT0gQ2F0w6Fsb2dvIEVtYnV0aWRvIChNb27Ds2xpdG8pID09PT09IC0tPgogIDxzY3JpcHQgaWQ9IkFQUFNfSlNPTiIgdHlwZT0iYXBwbGljYXRpb24vanNvbiI+CiAgewogICAgImFwcHMiOiBbCiAgICAgIHsia2V5IjoiYXRsYXMiLCJ0aXRsZSI6IkF0bGFzIMK3IENhcnRlc2l1cyIsImRlc2MiOiJQbGFuZWphZG9yIGVzdHJhdMOpZ2ljbyBjb20gY3Jvbm9ncmFtYXMgZSBjaGVja2xpc3RzLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6ImF0bGFzIn0sCiAgICAgIHsia2V5Ijoibm92YSIsInRpdGxlIjoiTm92YSDCtyBJbnNwaXJhIiwiZGVzYyI6IkNyaWF0aXZhIHF1ZSBkZXNibG9xdWVpYSBpZGVpYXMgY29tIG1hcGFzIG1lbnRhaXMgZSBleGVyY8OtY2lvcy4iLCJ1cmwiOiJhYm91dDpibGFuayIsImljb24iOiJub3ZhIn0sCiAgICAgIHsia2V5Ijoidml0YWxpcyIsInRpdGxlIjoiVml0YWxpcyDCtyBNb21lbnR1bSIsImRlc2MiOiJSb3RpbmFzIGbDrXNpY2FzLCBoYWNrcyBiaW9sw7NnaWNvcyBlIG1vdGl2YcOnw6NvLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6InZpdGFsaXMifSwKICAgICAgeyJrZXkiOiJwdWxzZSIsInRpdGxlIjoiUHVsc2UgwrcgUmVzb25hIiwiZGVzYyI6IlRyaWxoYXMgc29ub3JhcyBlIGFqdXN0ZSBkZSBzb20gZW1vY2lvbmFsLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6InB1bHNlIn0sCiAgICAgIHsia2V5IjoiYXJ0ZW1pcyIsInRpdGxlIjoiQXJ0ZW1pcyDCtyBOYXZpZ2EiLCJkZXNjIjoiRXhwbG9yYSBjb25oZWNpbWVudG9zIGUgcm90YXMgZGUgYXByZW5kaXphZG8uIiwidXJsIjoiYWJvdXQ6YmxhbmsiLCJpY29uIjoiYXJ0ZW1pcyJ9LAogICAgICB7ImtleSI6InNlcmVuYSIsInRpdGxlIjoiU2VyZW5hIMK3IEFtcGFyYSIsImRlc2MiOiJBY29saGltZW50byBlIHN1cG9ydGUgZW1vY2lvbmFsLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6InNlcmVuYSJ9LAogICAgICB7ImtleSI6Imthb3MiLCJ0aXRsZSI6Ikthb3MgwrcgRGlzcnVwdG9yIiwiZGVzYyI6IlF1ZXN0aW9uYSBwYWRyw7VlcyBlIHByb3DDtWUgc29sdcOnw7VlcyBvdXNhZGFzLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6Imthb3MifSwKICAgICAgeyJrZXkiOiJnZW51cyIsInRpdGxlIjoiR2VudXMgwrcgRmFicmljdXMiLCJkZXNjIjoiUHJvdMOzdGlwb3MgZSBtYXRlcmlhbGl6YcOnw6NvIGRlIGlkZWlhcy4iLCJ1cmwiOiJhYm91dDpibGFuayIsImljb24iOiJnZW51cyJ9LAogICAgICB7ImtleSI6Imx1bWluZSIsInRpdGxlIjoiTHVtaW5lIMK3IEJyaWxoYXJlIiwiZGVzYyI6Ikluc3BpcmHDp8OjbyBsZXZlIGUgYXRpdmlkYWRlcyBsw7pkaWNhcy4iLCJ1cmwiOiJhYm91dDpibGFuayIsImljb24iOiJsdW1pbmUifSwKICAgICAgeyJrZXkiOiJyaGVhIiwidGl0bGUiOiJSaGVhIMK3IFJhw616ZXMiLCJkZXNjIjoiVsOtbmN1bG9zIGUgbWVtw7NyaWFzIGVtb2Npb25haXMuIiwidXJsIjoiYWJvdXQ6YmxhbmsiLCJpY29uIjoicmhlYSJ9LAogICAgICB7ImtleSI6InNvbHVzIiwidGl0bGUiOiJTb2x1cyDCtyBBcmNhbmEiLCJkZXNjIjoiSGFybW9uaXphw6fDo28gZW5lcmfDqXRpY2EgZSBtZWRpdGHDp8Ojby4iLCJ1cmwiOiJhYm91dDpibGFuayIsImljb24iOiJzb2x1cyJ9LAogICAgICB7ImtleSI6ImFpb24iLCJ0aXRsZSI6IkFpb24gwrcgRXZvbHV0aWEiLCJkZXNjIjoiTWljcm9hw6fDtWVzIGVzdHJhdMOpZ2ljYXMgZSBldm9sdcOnw6NvLiIsInVybCI6ImFib3V0OmJsYW5rIiwiaWNvbiI6ImFpb24ifQogICAgXQogIH0KICA8L3NjcmlwdD4KCiAgPHNjcmlwdD4KICAgIC8qID09PT09PT09PT09PT09PT09PT09PSBIZWxwZXJzID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgY29uc3QgJCA9IChxLCByID0gZG9jdW1lbnQpID0+IHIucXVlcnlTZWxlY3RvcihxKTsKICAgIGNvbnN0ICQkID0gKHEsIHIgPSBkb2N1bWVudCkgPT4gQXJyYXkuZnJvbShyLnF1ZXJ5U2VsZWN0b3JBbGwocSkpOwogICAgY29uc3QgTFMgPSB7CiAgICAgIGdldDogKGssIGQpID0+IHsgdHJ5IHsgY29uc3QgdiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGspOyByZXR1cm4gdiA/IEpTT04ucGFyc2UodikgOiBkIH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGQgfSB9LAogICAgICBzZXQ6IChrLCB2KSA9PiB7IHRyeSB7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKGssIEpTT04uc3RyaW5naWZ5KHYpKSB9IGNhdGNoIChlKSB7fSB9LAogICAgICByYXc6IChrKSA9PiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrKSB8fCAnJwogICAgfTsKCiAgICAvKiBSaXBwbGUgKi8KICAgIGZ1bmN0aW9uIGFkZFJpcHBsZShlbCkgewogICAgICBpZiAoIWVsKSByZXR1cm47CiAgICAgIC8vIEVuc3VyZSBhIHJpcHBsZSBob3N0IGV4aXN0cyBvbiB0aGUgZWxlbWVudC4gVGhlIGdsb2JhbCByaXBwbGUgaGFuZGxlciB3aWxsIGNyZWF0ZSBkb3RzIG9uIHBvaW50ZXJkb3duLgogICAgICBpZiAoIWVsLnF1ZXJ5U2VsZWN0b3IoJy5yaXBwbGUnKSkgewogICAgICAgIGNvbnN0IHNsb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgc2xvdC5jbGFzc05hbWUgPSAncmlwcGxlJzsKICAgICAgICBlbC5hcHBlbmRDaGlsZChzbG90KTsKICAgICAgfQogICAgICAvLyBEbyBub3QgYXR0YWNoIGluZGl2aWR1YWwgcG9pbnRlcmRvd24gZXZlbnRzIGhlcmU7IHJpcHBsZSB3aWxsIGJlIGhhbmRsZWQgZ2xvYmFsbHkuCiAgICB9CgogICAgLyogVG9hc3QgKi8KICAgIGNvbnN0IHRvYXN0Qm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB0b2FzdEJveC5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmZpeGVkO3JpZ2h0OjE0cHg7Ym90dG9tOmNhbGModmFyKC0tdGFic0gpICsgMTZweCk7ZGlzcGxheTpncmlkO2dhcDo4cHg7ei1pbmRleDoxMjAnOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0b2FzdEJveCk7CiAgICBmdW5jdGlvbiB0b2FzdChtc2csIHR5cGUgPSAnb2snKSB7CiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGVsLmNsYXNzTmFtZSA9ICdmeC10cmFucyc7CiAgICAgIGNvbnN0IGJnID0gdHlwZSA9PT0gJ29rJyA/ICdsaW5lYXItZ3JhZGllbnQoOTBkZWcsIzFiMmEyYSwjMTIzYzJlKScgOiAodHlwZSA9PT0gJ3dhcm4nID8gJ2xpbmVhci1ncmFkaWVudCg5MGRlZywjMmYyNjFiLCMzYzJkMTIpJyA6ICdsaW5lYXItZ3JhZGllbnQoOTBkZWcsIzJmMWIxYiwjM2MxMjEyKScpOwogICAgICBlbC5zdHlsZS5jc3NUZXh0ID0gYGJhY2tncm91bmQ6JHtiZ307IGNvbG9yOnZhcigtLWZnKTsgYm9yZGVyOiR7Z2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoJy0tYmQnKX07IHBhZGRpbmc6LjZyZW0gLjhyZW07IGJvcmRlci1yYWRpdXM6MTJweDsgYm94LXNoYWRvdzp2YXIoLS1zaGFkb3cpYDsKICAgICAgZWwudGV4dENvbnRlbnQgPSBtc2c7IHRvYXN0Qm94LmFwcGVuZENoaWxkKGVsKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGVsLnN0eWxlLm9wYWNpdHkgPSAuMDsgZWwuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoNnB4KSc7IHNldFRpbWVvdXQoKCkgPT4gZWwucmVtb3ZlKCksIDIyMCk7IH0sIDE2MDApOwogICAgfQoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PSBTYXVkYcOnw6NvIC8gw7psdGltbyBlc3RhZG8gPT09PT09PT09PT09PT09PT09PT09ICovCiAgICBmdW5jdGlvbiBkaXNwbGF5R3JlZXRpbmcoKSB7CiAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3JlZXRpbmdDYXJkJyk7CiAgICAgIGNvbnN0IG1zZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyZWV0aW5nTXNnJyk7CiAgICAgIGlmICghY2FyZCB8fCAhbXNnRWwpIHJldHVybjsKICAgICAgY29uc3QgbmFtZSA9IChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaW5mb2Rvc2U6dXNlck5hbWUnKSB8fCAnJykudHJpbSgpOwogICAgICBjb25zdCBzZXNzaW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXNzaW9uJykubGVuZ3RoOwogICAgICBpZiAoIW5hbWUpIHsKICAgICAgICBjYXJkLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIC8vIFF1YW5kbyBvIHVzdcOhcmlvIGFpbmRhIG7Do28gaW5mb3Jtb3UgbyBub21lLCBpbmNlbnRpdmFtb3MgbyBjYWRhc3RybyBsb2NhbC4KICAgICAgICBtc2dFbC50ZXh0Q29udGVudCA9ICdTYWx2ZSEgQXRpdmUgc3VhIER1YWzigK9JbmZvZG9zZSByZWdpc3RyYW5kbyBzZXUgbm9tZSBuYSBzZcOnw6NvIEJyYWluLic7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FyZC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAvLyBBcMOzcyBjYWRhc3RyYWRvLCBzYXVkYW1vcyBlIGluZm9ybWFtb3MgcXVhbnRhcyBzZXNzw7VlcyBlc3TDo28gZW0gYW5kYW1lbnRvLiAgTyBub21lIGRvIGFzc2lzdGVudGUKICAgICAgICAvLyAo4oCcVU5P4oCdKSDDqSBpbmNsdcOtZG8gcGFyYSByZWZvcsOnYXIgYSBwcmVzZW7Dp2EgZG8gaHViLgogICAgICAgIG1zZ0VsLnRleHRDb250ZW50ID0gYEJlbS12aW5kbyBkZSB2b2x0YSwgJHtuYW1lfS4gVU5PIGVzdMOhIGFvIHNldSBsYWRvLiBWb2PDqiB0ZW0gJHtzZXNzaW9uc30gc2Vzc8OjbyjDtWVzKSBhdGl2YShzKS5gOwogICAgICB9CiAgICB9CgogICAgLyogPT09PT09PT09PT09PT09PT09PT09IFRlbWEgJiBGdW5kbyBwZXJzb25hbGl6YWRvcyA9PT09PT09PT09PT09PT09PT09PT0gKi8KICAgIC8vIEFwbGljYSBvIHRlbWEgc2Fsdm8gbm8gbG9jYWxTdG9yYWdlLiBPcyB0ZW1hcyBwb3Nzw612ZWlzIHPDo286ICdkZWZhdWx0JyAocmVtb3ZlIGRhdGEtdGhlbWUpLCAnbWVkaXVtJwogICAgLy8gZSAnY3VzdG9tJy4gIFF1YW5kbyAnY3VzdG9tJyBlc3RpdmVyIGF0aXZvLCB1c2EgYSBpbWFnZW0vdsOtZGVvIHNhbHZvIGVtIExTICgndW5vOmJnJykgY29tbwogICAgLy8gcGxhbm8gZGUgZnVuZG8uICBTZSAnbWVkaXVtJyBlc3RpdmVyIHNlbGVjaW9uYWRvLCBhZGljaW9uYSBkYXRhLXRoZW1lPSdtZWRpdW0nLgogICAgZnVuY3Rpb24gYXBwbHlUaGVtZSgpIHsKICAgICAgY29uc3QgdGhlbWUgPSBMUy5nZXQoJ3Vubzp0aGVtZScsICdtZWRpdW0nKTsKICAgICAgLy8gTGltcGUgcXVhbHF1ZXIgZGF0YXNldCBwYXJhIHF1ZSBDU1MgZGVmYXVsdCBzZWphIGFwbGljYWRvIHF1YW5kbyAnZGVmYXVsdCcKICAgICAgaWYgKHRoZW1lID09PSAnZGVmYXVsdCcpIHsKICAgICAgICBkZWxldGUgZG9jdW1lbnQuYm9keS5kYXRhc2V0LnRoZW1lOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmJvZHkuZGF0YXNldC50aGVtZSA9IHRoZW1lOwogICAgICB9CiAgICAgIC8vIEdlcmVuY2lhciBmdW5kbyBwZXJzb25hbGl6YWRvCiAgICAgIGNvbnN0IGJnQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbS1iZycpOwogICAgICBpZiAoIWJnQ29udGFpbmVyKSByZXR1cm47CiAgICAgIGlmICh0aGVtZSAhPT0gJ2N1c3RvbScpIHsKICAgICAgICBiZ0NvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8gQ2FycmVnYXIgZGFkb3MgZG8gZnVuZG8KICAgICAgY29uc3QgYmdEYXRhID0gTFMuZ2V0KCd1bm86YmcnLCAnJyk7CiAgICAgIGJnQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICBpZiAoIWJnRGF0YSkgcmV0dXJuOwogICAgICAvLyBEZXRlcm1pbmUgc2Ugw6kgdsOtZGVvIG91IGltYWdlbQogICAgICBpZiAoL15kYXRhOnZpZGVvXC8vLnRlc3QoYmdEYXRhKSkgewogICAgICAgIGNvbnN0IHZpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7CiAgICAgICAgdmlkLnNyYyA9IGJnRGF0YTsKICAgICAgICB2aWQuYXV0b3BsYXkgPSB0cnVlOwogICAgICAgIHZpZC5sb29wID0gdHJ1ZTsKICAgICAgICB2aWQubXV0ZWQgPSB0cnVlOwogICAgICAgIHZpZC5wbGF5c0lubGluZSA9IHRydWU7CiAgICAgICAgdmlkLnN0eWxlLndpZHRoID0gJzEwMCUnOwogICAgICAgIHZpZC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7CiAgICAgICAgdmlkLnN0eWxlLm9iamVjdEZpdCA9ICdjb3Zlcic7CiAgICAgICAgYmdDb250YWluZXIuYXBwZW5kQ2hpbGQodmlkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKICAgICAgICBpbWcuc3JjID0gYmdEYXRhOwogICAgICAgIGltZy5hbHQgPSAnJzsKICAgICAgICBpbWcuc3R5bGUud2lkdGggPSAnMTAwJSc7CiAgICAgICAgaW1nLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsKICAgICAgICBpbWcuc3R5bGUub2JqZWN0Rml0ID0gJ2NvdmVyJzsKICAgICAgICBiZ0NvbnRhaW5lci5hcHBlbmRDaGlsZChpbWcpOwogICAgICB9CiAgICB9CgogICAgLyogPT09PT09PT09PT09PT09PT09PT09IENTUyBQZXJzb25hbGl6YWRvID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgLy8gQXBsaWNhIG8gQ1NTIHNhbHZvIGVtIGxvY2FsU3RvcmFnZSAoY2hhdmUgJ2luZm9kb3NlOmNzc0N1c3RvbScpCiAgICBmdW5jdGlvbiBhcHBseUNTUygpIHsKICAgICAgbGV0IHN0eWxlRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9tU3R5bGUnKTsKICAgICAgaWYgKCFzdHlsZUVsKSB7CiAgICAgICAgc3R5bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgc3R5bGVFbC5pZCA9ICdjdXN0b21TdHlsZSc7CiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsKTsKICAgICAgfQogICAgICBjb25zdCBjc3MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaW5mb2Rvc2U6Y3NzQ3VzdG9tJykgfHwgJyc7CiAgICAgIHN0eWxlRWwuaW5uZXJIVE1MID0gY3NzIHx8ICcnOwogICAgfQoKICAgIC8vIEluaWNpYWxpemEgc2VsZcOnw6NvIGRlIHZvemVzIHBhcmEgY2FkYSBhcnF1w6l0aXBvCiAgICBmdW5jdGlvbiBpbml0Vm9pY2VzKCkgewogICAgICBjb25zdCB3cmFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZvaWNlc1dyYXAnKTsKICAgICAgaWYgKCF3cmFwKSByZXR1cm47CiAgICAgIHdyYXAuaW5uZXJIVE1MID0gJyc7CiAgICAgIGNvbnN0IGFyY2hMaXN0ID0gWyAnTHV4YXJhJywnUmhlYScsJ0Fpb24nLCdBdGxhcycsJ05vdmEnLCdHZW51cycsJ0x1bWluZScsJ0thaW9uJywnS2FvcycsJ0hvcnVzJywnRWx5c2hhJywnU2VyZW5hJyBdOwogICAgICBmdW5jdGlvbiBwb3B1bGF0ZVZvaWNlcygpIHsKICAgICAgICBsZXQgdm9pY2VzID0gc3BlZWNoU3ludGhlc2lzLmdldFZvaWNlcygpOwogICAgICAgIC8vIEZpbHRyYXIgcG9yIGlkaW9tYXMgc3Vwb3J0YWRvcyAoUG9ydHVndcOqcyBlIEluZ2zDqnMpIHNlIGRpc3BvbsOtdmVsCiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSB2b2ljZXMuZmlsdGVyKHYgPT4gdi5sYW5nICYmICh2Lmxhbmcuc3RhcnRzV2l0aCgncHQnKSB8fCB2Lmxhbmcuc3RhcnRzV2l0aCgnZW4nKSkpOwogICAgICAgIHZvaWNlcyA9IGZpbHRlcmVkLmxlbmd0aCA/IGZpbHRlcmVkIDogdm9pY2VzOwogICAgICAgIGNvbnN0IHNhdmVkID0gTFMuZ2V0KCdpbmZvZG9zZTp2b2ljZXMnLCB7fSk7CiAgICAgICAgYXJjaExpc3QuZm9yRWFjaChuYW1lID0+IHsKICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICByb3cuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInOwogICAgICAgICAgcm93LnN0eWxlLmdhcCA9ICc4cHgnOwogICAgICAgICAgcm93LnN0eWxlLmZsZXhXcmFwID0gJ3dyYXAnOwogICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IG5hbWU7CiAgICAgICAgICBsYWJlbC5zdHlsZS5taW5XaWR0aCA9ICc3MHB4JzsKICAgICAgICAgIGxhYmVsLnN0eWxlLmZvbnRXZWlnaHQgPSAnNzAwJzsKICAgICAgICAgIGNvbnN0IHNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpOwogICAgICAgICAgc2VsLmNsYXNzTmFtZSA9ICdpbnB1dCByaW5nJzsKICAgICAgICAgIHNlbC5zdHlsZS5tYXhXaWR0aCA9ICcyMjBweCc7CiAgICAgICAgICB2b2ljZXMuZm9yRWFjaCh2ID0+IHsKICAgICAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgICAgIG9wdC52YWx1ZSA9IHYubmFtZTsKICAgICAgICAgICAgb3B0LnRleHRDb250ZW50ID0gYCR7di5uYW1lfSAoJHt2Lmxhbmd9KWA7CiAgICAgICAgICAgIHNlbC5hcHBlbmRDaGlsZChvcHQpOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoc2F2ZWRbbmFtZV0pIHNlbC52YWx1ZSA9IHNhdmVkW25hbWVdOwogICAgICAgICAgc2VsLm9uY2hhbmdlID0gKCkgPT4gewogICAgICAgICAgICBzYXZlZFtuYW1lXSA9IHNlbC52YWx1ZTsKICAgICAgICAgICAgTFMuc2V0KCdpbmZvZG9zZTp2b2ljZXMnLCBzYXZlZCk7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgYnRuVGVzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgYnRuVGVzdC5jbGFzc05hbWUgPSAnYnRuIGZ4LXRyYW5zIGZ4LXByZXNzIHJpbmcnOwogICAgICAgICAgYnRuVGVzdC50ZXh0Q29udGVudCA9ICdUZXN0ZSc7CiAgICAgICAgICBjb25zdCBycCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgcnAuY2xhc3NOYW1lID0gJ3JpcHBsZSc7IGJ0blRlc3QuYXBwZW5kQ2hpbGQocnApOwogICAgICAgICAgYWRkUmlwcGxlKGJ0blRlc3QpOwogICAgICAgICAgYnRuVGVzdC5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICBjb25zdCB1dHRlciA9IG5ldyBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UoYE9sw6EsIGV1IHNvdSAke25hbWV9YCk7CiAgICAgICAgICAgIGNvbnN0IHZvaWNlTmFtZSA9IHNhdmVkW25hbWVdIHx8IHNlbC52YWx1ZTsKICAgICAgICAgICAgY29uc3Qgdm9pY2UgPSB2b2ljZXMuZmluZCh2ID0+IHYubmFtZSA9PT0gdm9pY2VOYW1lKTsKICAgICAgICAgICAgaWYgKHZvaWNlKSB1dHRlci52b2ljZSA9IHZvaWNlOwogICAgICAgICAgICBzcGVlY2hTeW50aGVzaXMuY2FuY2VsKCk7CiAgICAgICAgICAgIHNwZWVjaFN5bnRoZXNpcy5zcGVhayh1dHRlcik7CiAgICAgICAgICB9OwogICAgICAgICAgcm93LmFwcGVuZENoaWxkKGxhYmVsKTsKICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChzZWwpOwogICAgICAgICAgcm93LmFwcGVuZENoaWxkKGJ0blRlc3QpOwogICAgICAgICAgd3JhcC5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHBvcHVsYXRlVm9pY2VzKCk7CiAgICAgIC8vIFJlLXBvcHVsYXRlIHdoZW4gdm9pY2VzIGxpc3QgY2hhbmdlcwogICAgICB3aW5kb3cuc3BlZWNoU3ludGhlc2lzLm9udm9pY2VzY2hhbmdlZCA9ICgpID0+IHBvcHVsYXRlVm9pY2VzKCk7CiAgICB9CgogICAgLy8gUHJvbnVuY2lhIG8gbm9tZSBkbyBhcnF1w6l0aXBvIHVzYW5kbyBhIHZveiBzZWxlY2lvbmFkYQogICAgZnVuY3Rpb24gc3BlYWtBcmNoZXR5cGUobmFtZSkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IGFyY2hOYW1lID0gbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCBzYXZlZCA9IExTLmdldCgnaW5mb2Rvc2U6dm9pY2VzJywge30pOwogICAgICAgIGNvbnN0IHZvaWNlcyA9IHNwZWVjaFN5bnRoZXNpcy5nZXRWb2ljZXMoKTsKICAgICAgICBsZXQgdm9pY2UgPSBudWxsOwogICAgICAgIGlmIChzYXZlZCAmJiBzYXZlZFthcmNoTmFtZV0pIHsKICAgICAgICAgIHZvaWNlID0gdm9pY2VzLmZpbmQodiA9PiB2Lm5hbWUgPT09IHNhdmVkW2FyY2hOYW1lXSk7CiAgICAgICAgfQogICAgICAgIGlmICghdm9pY2UpIHsKICAgICAgICAgIHZvaWNlID0gdm9pY2VzLmZpbmQodiA9PiB2LmxhbmcgJiYgKHYubGFuZy5zdGFydHNXaXRoKCdwdCcpIHx8IHYubGFuZy5zdGFydHNXaXRoKCdlbicpKSk7CiAgICAgICAgfQogICAgICAgIGlmICghdm9pY2UgJiYgdm9pY2VzLmxlbmd0aCkgdm9pY2UgPSB2b2ljZXNbMF07CiAgICAgICAgaWYgKCF2b2ljZSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHV0dGVyID0gbmV3IFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZShgT2zDoSwgZXUgc291ICR7YXJjaE5hbWV9YCk7CiAgICAgICAgdXR0ZXIudm9pY2UgPSB2b2ljZTsKICAgICAgICBzcGVlY2hTeW50aGVzaXMuY2FuY2VsKCk7CiAgICAgICAgc3BlZWNoU3ludGhlc2lzLnNwZWFrKHV0dGVyKTsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0KCiAgICAvLyBNZW5zYWdlbSBkZSBib2FzLXZpbmRhcy9hdGl2YcOnw6NvCiAgICBmdW5jdGlvbiB3ZWxjb21lKCkgewogICAgICBjb25zdCBuYW1lID0gKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdpbmZvZG9zZTp1c2VyTmFtZScpIHx8ICcnKS50cmltKCk7CiAgICAgIGlmICghbmFtZSkgewogICAgICAgIHRvYXN0KCdTYWx2ZSEgQXRpdmUgc3VhIER1YWzigK9JbmZvZG9zZSByZWdpc3RyYW5kbyBzZXUgbm9tZSBuYSBzZcOnw6NvIEJyYWluLicsICd3YXJuJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdG9hc3QoYEJlbS12aW5kbyBkZSB2b2x0YSwgJHtuYW1lfS4gVU5PIGVzdMOhIGFvIHNldSBsYWRvLmAsICdvaycpOwogICAgICB9CiAgICB9CgogICAgLyogQXBwbHkgcmlwcGxlICovCiAgICAkJCgnYnV0dG9uJykuZm9yRWFjaChhZGRSaXBwbGUpOwogICAgLy8gTW92ZSB0aGUgYXJxdcOpdGlwb3MgY2lyY2xlIGJlbG93IHRoZSBtZW51IGluIHRoZSBob21lIHZpZXcgYWZ0ZXIgaW5pdGlhbGl6YXRpb24KICAgIChmdW5jdGlvbigpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBob21lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3YtaG9tZScpOwogICAgICAgIGlmICghaG9tZSkgcmV0dXJuOwogICAgICAgIGNvbnN0IGFyY2ggPSBob21lLnF1ZXJ5U2VsZWN0b3IoJy5hcmNoLWNvbnRhaW5lcicpOwogICAgICAgIGNvbnN0IGNhcmRzID0gaG9tZS5xdWVyeVNlbGVjdG9yKCcuY2FyZHMnKTsKICAgICAgICAvLyBTZSBhbWJvcyBleGlzdGlyZW0sIGdhcmFudGEgcXVlIGFzIGNhcnRhcyBhcGFyZcOnYW0gZGVwb2lzIGRvIGPDrXJjdWxvIGRlIGFycXXDqXRpcG9zLgogICAgICAgIGlmIChhcmNoICYmIGNhcmRzKSB7CiAgICAgICAgICBhcmNoLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBjYXJkcyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdGYWxoYSBhbyByZXBvc2ljaW9uYXIgYXJxdcOpdGlwbzonLCBlKTsKICAgICAgfQogICAgfSkoKTsKICAgIGNvbnN0IG9icyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRzKSA9PiB7IG11dHMuZm9yRWFjaChtID0+IG0uYWRkZWROb2RlcyAmJiBtLmFkZGVkTm9kZXMuZm9yRWFjaChuID0+IHsgaWYgKG4ubm9kZVR5cGUgPT09IDEpIHsgaWYgKG4ubWF0Y2hlcz8uKCdidXR0b24nKSkgYWRkUmlwcGxlKG4pOyBuLnF1ZXJ5U2VsZWN0b3JBbGw/LignYnV0dG9uJykuZm9yRWFjaChhZGRSaXBwbGUpOyB9IH0pKSB9KTsKICAgIG9icy5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOwoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PSBOYXZlZ2HDp8OjbyArIEVzdGFkbyA9PT09PT09PT09PT09PT09PT09PT0gKi8KICAgIGZ1bmN0aW9uIG5hdihrZXkpIHsKICAgICAgLy8gQWRpY2lvbmFtb3MgJ3Jldm8nIMOgIGxpc3RhIGRlIGFiYXMgcGFyYSBzdXBvcnRhciBhIG5vdmEgc2XDp8OjbwogICAgICBjb25zdCB0YWJzID0gWydob21lJywgJ2FwcHMnLCAnc3RhY2snLCAnYnJhaW4nLCAncmV2byddOwogICAgICB0YWJzLmZvckVhY2goayA9PiB7ICQoJyN2LScgKyBrKS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBrID09PSBrZXkpOyAkKGAudGFiW2RhdGEtbmF2PSIke2t9Il1gKS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBrID09PSBrZXkpOyB9KTsKICAgICAgTFMuc2V0KCd1bm86bGFzdFRhYicsIGtleSk7CiAgICAgIC8vIFF1YW5kbyBlbnRyYXIgbmEgYWJhIEhvbWUsIGFwcmVzZW50ZSBtZW5zYWdlbSBkZSBzYXVkYcOnw6NvIC8gw7psdGltYSBzZXNzw6NvCiAgICAgIGlmIChrZXkgPT09ICdob21lJykgewogICAgICAgIHRyeSB7IGRpc3BsYXlHcmVldGluZygpOyB9IGNhdGNoIChlKSB7IGNvbnNvbGUud2FybihlKTsgfQogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBuYW1lRyA9IChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaW5mb2Rvc2U6dXNlck5hbWUnKSB8fCAnJykudHJpbSgpOwogICAgICAgICAgaWYgKCFuYW1lRykgewogICAgICAgICAgICB0b2FzdCgnU2FsdmUhIEF0aXZlIHN1YSBEdWFs4oCvSW5mb2Rvc2UgcmVnaXN0cmFuZG8gc2V1IG5vbWUgbmEgc2XDp8OjbyBCcmFpbi4nLCAnd2FybicpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gU2F1ZGHDp8OjbyByw6FwaWRhIG5hIGZvcm1hIGRlIHRvYXN0IHF1YW5kbyBvIHVzdcOhcmlvIHJldG9ybmEgYW8gaG9tZS4KICAgICAgICAgICAgdG9hc3QoYEJlbS12aW5kbyBkZSB2b2x0YSwgJHtuYW1lR30uIFVOTyBlc3TDoSBhbyBzZXUgbGFkby5gLCAnb2snKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIC8vIEF0dWFsaXplIHRhbWLDqW0gb3Mgc3RhdHVzIHF1YW5kbyBlbnRyYXIgbm8gSG9tZQogICAgICAgIHRyeSB7IHVwZGF0ZUhvbWVTdGF0dXMoKTsgfSBjYXRjaCB7fQogICAgICB9CiAgICAgIC8vIFF1YW5kbyBlbnRyYXIgbmEgYWJhIFJldm8sIGVudmllIGEgbGlzdGEgZGUgYXBwcyBhbyBpZnJhbWUgdmlhIHBvc3RNZXNzYWdlCiAgICAgIGlmIChrZXkgPT09ICdyZXZvJykgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBhcHBzID0gUkFXICYmIEFycmF5LmlzQXJyYXkoUkFXLmFwcHMpID8gUkFXLmFwcHMgOiBbXTsKICAgICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZvRW1iZWQnKTsKICAgICAgICAgIGlmIChpZnJhbWUpIHsKICAgICAgICAgICAgLy8gSWYgaWZyYW1lIGFscmVhZHkgbG9hZGVkLCBzZW5kIGltbWVkaWF0ZWx5CiAgICAgICAgICAgIGNvbnN0IHNlbmQgPSAoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGlmcmFtZS5jb250ZW50V2luZG93KSB7CiAgICAgICAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZSh7IHR5cGU6ICdhcHBzJywgYXBwcyB9LCAnKicpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgLy8gQWx3YXlzIHNlbmQgYSBtZXNzYWdlIGFmdGVyIGEgdGlueSBkZWxheSBpbiBjYXNlIHRoZSBmcmFtZSBpcyBzdGlsbCBpbml0aWFsaXppbmcKICAgICAgICAgICAgc2V0VGltZW91dChzZW5kLCAxMDApOwogICAgICAgICAgICAvLyBBbHNvIHNlbmQgYWdhaW4gb25jZSB0aGUgaWZyYW1lIGxvYWRzCiAgICAgICAgICAgIGlmcmFtZS5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgaWZyYW1lLl9zZW5kQXBwcyk7CiAgICAgICAgICAgIGlmcmFtZS5fc2VuZEFwcHMgPSBzZW5kOwogICAgICAgICAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHNlbmQsIHsgb25jZTogdHJ1ZSB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgIGNvbnNvbGUud2FybignRmFsaGEgYW8gZW52aWFyIGFwcHMgYW8gUmV2bzonLCBlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyBIZWxwZXI6IHNlIGEgYWJhIFJldm8gZXN0aXZlciBhdGl2YSwgZW52aWEgYSBsaXN0YSBhdHVhbCBkZSBhcHBzIGFvIGlmcmFtZS4gIAogICAgZnVuY3Rpb24gbWF5YmVTZW5kQXBwc1RvUmV2bygpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyBTw7MgZW52aWUgc2UgYSBhYmEgUmV2byBlc3RpdmVyIHZpc8OtdmVsCiAgICAgICAgY29uc3QgdmlldyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2LXJldm8nKTsKICAgICAgICBpZiAoIXZpZXcgfHwgIXZpZXcuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkgcmV0dXJuOwogICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZvRW1iZWQnKTsKICAgICAgICBjb25zdCBhcHBzID0gUkFXICYmIEFycmF5LmlzQXJyYXkoUkFXLmFwcHMpID8gUkFXLmFwcHMgOiBbXTsKICAgICAgICBpZiAoaWZyYW1lICYmIGlmcmFtZS5jb250ZW50V2luZG93KSB7CiAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZSh7IHR5cGU6ICdhcHBzJywgYXBwcyB9LCAnKicpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignRmFsaGEgYW8gZW52aWFyIGFwcHMgYW8gUmV2byAobWF5YmUpOicsIGUpOwogICAgICB9CiAgICB9CiAgICAkJCgnLnRhYixbZGF0YS1uYXZdJykuZm9yRWFjaChiID0+IGIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBuYXYoYi5kYXRhc2V0Lm5hdiB8fCAnaG9tZScpKSk7CiAgICAkKCcjYnRuQmFjaycpLm9uY2xpY2sgPSAoKSA9PiB7IHRyeSB7IGhpc3RvcnkubGVuZ3RoID4gMSAmJiBoaXN0b3J5LmJhY2soKSB9IGNhdGNoIHsgfSB9OwogICAgJCgnI2J0bkJyYWluJykub25jbGljayA9ICgpID0+IG5hdignYnJhaW4nKTsKCiAgICAvLyBSZXN0YXVyYXIgw7psdGltYSBhYmEKICAgIGNvbnN0IGxhc3QgPSBMUy5nZXQoJ3VubzpsYXN0VGFiJywgJ2hvbWUnKTsKICAgIG5hdihsYXN0KTsKICAgIC8vIFNlIGEgYWJhIGluaWNpYWwgZm9yIGhvbWUsIGV4aWJpciBzYXVkYcOnw6NvCiAgICBpZiAobGFzdCA9PT0gJ2hvbWUnKSB7CiAgICAgIHRyeSB7IGRpc3BsYXlHcmVldGluZygpOyB9IGNhdGNoKGUpIHt9CiAgICB9CgogICAgLy8gQXRhbGhvcwogICAgbGV0IGdQcmVzc2VkID0gZmFsc2U7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7CiAgICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3MnKSB7IGUucHJldmVudERlZmF1bHQoKTsgZG93bmxvYWRTZWxmKCk7IHJldHVybjsgfQogICAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICdrJykgeyBlLnByZXZlbnREZWZhdWx0KCk7ICQoJyNhcHBTZWFyY2gnKT8uZm9jdXMoKTsgcmV0dXJuOyB9CiAgICAgIGlmIChlLmtleS50b0xvd2VyQ2FzZSgpID09PSAnZycpIHsgZ1ByZXNzZWQgPSB0cnVlOyBzZXRUaW1lb3V0KCgpID0+IGdQcmVzc2VkID0gZmFsc2UsIDYwMCk7IHJldHVybjsgfQogICAgICBpZiAoIWdQcmVzc2VkKSByZXR1cm47IGNvbnN0IGsgPSBlLmtleS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAoayA9PT0gJ2gnKSBuYXYoJ2hvbWUnKTsgaWYgKGsgPT09ICdhJykgbmF2KCdhcHBzJyk7IGlmIChrID09PSAncycpIG5hdignc3RhY2snKTsgaWYgKGsgPT09ICdiJykgbmF2KCdicmFpbicpOyBpZiAoayA9PT0gJ3InKSBuYXYoJ3Jldm8nKTsgZ1ByZXNzZWQgPSBmYWxzZTsKICAgIH0pOwoKICAgIC8vIEFqdWRhIG1vZGFsCiAgICBjb25zdCBtb2RhbEhlbHAgPSAkKCcjbW9kYWxIZWxwJyk7CiAgICAkKCcjYnRuSGVscCcpLm9uY2xpY2sgPSAoKSA9PiB7IG1vZGFsSGVscC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7IG1vZGFsSGVscC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7IH07CiAgICAkKCcjY2xvc2VIZWxwJykub25jbGljayA9ICgpID0+IHsgbW9kYWxIZWxwLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTsgbW9kYWxIZWxwLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpOyB9OwogICAgbW9kYWxIZWxwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsgaWYgKGUudGFyZ2V0ID09PSBtb2RhbEhlbHApICQoJyNjbG9zZUhlbHAnKS5jbGljaygpOyB9KTsKCiAgICAvLyBCYWl4YXIgSFRNTAogICAgZnVuY3Rpb24gZG93bmxvYWRTZWxmKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IGNsb25lID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsb25lTm9kZSh0cnVlKTsKICAgICAgICBjb25zdCBodG1sID0gJzwhZG9jdHlwZSBodG1sPlxuJyArIGNsb25lLm91dGVySFRNTDsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2h0bWxdLCB7IHR5cGU6ICd0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCcgfSk7CiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsgYS5kb3dubG9hZCA9ICdIVUItVU5PLVJldm8uaHRtbCc7IGEuY2xpY2soKTsgc2V0VGltZW91dCgoKSA9PiBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZiksIDUwMCk7CiAgICAgICAgdG9hc3QoJ0hUTUwgZXhwb3J0YWRvJywgJ29rJyk7CiAgICAgIH0gY2F0Y2ggKGUpIHsgYWxlcnQoJ0ZhbGhhIGFvIGV4cG9ydGFyOiAnICsgZS5tZXNzYWdlKTsgfQogICAgfQogICAgJCgnI2J0bkRvd25sb2FkJykub25jbGljayA9IGRvd25sb2FkU2VsZjsKCiAgICAvKiA9PT09PT09PT09PT09PT09PT09PT0gQnJhaW4gPT09PT09PT09PT09PT09PT09PT09ICovCiAgICBjb25zdCBNT0RFTFMgPSBbJ29wZW5yb3V0ZXIvYXV0bycsJ2FudGhyb3BpYy9jbGF1ZGUtMy41LXNvbm5ldCcsJ29wZW5haS9ncHQtNC4xLW1pbmknLCdnb29nbGUvZ2VtaW5pLTEuNS1wcm8nLCdtZXRhL2xsYW1hLTMuMS00MDViLWluc3RydWN0JywnbWlzdHJhbC9taXN0cmFsLWxhcmdlLWxhdGVzdCddOwogICAgKGZ1bmN0aW9uIGluaXRCcmFpbigpIHsKICAgICAgY29uc3Qgc2VsID0gJCgnI21vZGVsJyk7IHNlbC5pbm5lckhUTUwgPSAnJzsgTU9ERUxTLmZvckVhY2gobSA9PiB7IGNvbnN0IG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsgby52YWx1ZSA9IG07IG8udGV4dENvbnRlbnQgPSBtOyBzZWwuYXBwZW5kQ2hpbGQobykgfSk7CiAgICAgIHNlbC52YWx1ZSA9IExTLmdldCgnZHVhbC5vcGVucm91dGVyLm1vZGVsJywgTU9ERUxTWzBdKTsKICAgICAgJCgnI3NrJykudmFsdWUgPSBMUy5yYXcoJ2R1YWwua2V5cy5vcGVucm91dGVyJyk7CiAgICAgICQoJyNzYXZlU0snKS5vbmNsaWNrID0gKCkgPT4geyBMUy5zZXQoJ2R1YWwub3BlbnJvdXRlci5tb2RlbCcsIHNlbC52YWx1ZSk7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdkdWFsLmtleXMub3BlbnJvdXRlcicsICQoJyNzaycpLnZhbHVlIHx8ICcnKTsgdG9hc3QoJ0NvbmZpZ3VyYcOnw7VlcyBzYWx2YXMnLCAnb2snKTsgfTsKICAgICAgJCgnI3NhdmVOYW1lJykub25jbGljayA9ICgpID0+IHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaW5mb2Rvc2U6dXNlck5hbWUnLCAoJCgnI3VzZXJOYW1lJykudmFsdWUgfHwgJycpLnRyaW0oKSk7CiAgICAgICAgdG9hc3QoJ05vbWUgc2Fsdm8nLCAnb2snKTsKICAgICAgICB0cnkgeyBkaXNwbGF5R3JlZXRpbmcoKTsgfSBjYXRjaCAoZSkge30KICAgICAgICB0cnkgeyB1cGRhdGVIb21lU3RhdHVzKCk7IH0gY2F0Y2gge30KICAgICAgfTsKICAgIH0pKCk7CgogICAgLyogPT09PT09PT09PT09PT09PT09PT09IEluaWNpYWxpemHDp8OjbyBkbyB0ZW1hICYgcGVyc29uYWxpemHDp8OjbyBkZSBmdW5kbyA9PT09PT09PT09PT09PT09PT09PT0gKi8KICAgIChmdW5jdGlvbiBpbml0VGhlbWVTZXR0aW5ncygpIHsKICAgICAgLy8gU2UgbyB1c3XDoXJpbyBudW5jYSBzZWxlY2lvbm91IHVtIHRlbWEgYW50ZXMsIGRlZmluYSBvIHBhZHLDo28gY29tbyAibWVkaXVtIiAoY2luemEpLgogICAgICBpZiAoIUxTLmdldCgndW5vOnRoZW1lJykpIHsKICAgICAgICBMUy5zZXQoJ3Vubzp0aGVtZScsICdtZWRpdW0nKTsKICAgICAgfQogICAgICAvLyBBcGxpcXVlIG8gdGVtYSBzYWx2byBpbWVkaWF0YW1lbnRlCiAgICAgIGFwcGx5VGhlbWUoKTsKICAgICAgLy8gQ29uZmlndXJlIG8gc2VsZXRvciBkZSB0ZW1hCiAgICAgIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZVNlbGVjdCcpOwogICAgICBpZiAoc2VsKSB7CiAgICAgICAgc2VsLnZhbHVlID0gTFMuZ2V0KCd1bm86dGhlbWUnLCAnbWVkaXVtJyk7CiAgICAgICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHsKICAgICAgICAgIExTLnNldCgndW5vOnRoZW1lJywgc2VsLnZhbHVlKTsKICAgICAgICAgIGFwcGx5VGhlbWUoKTsKICAgICAgICAgIHRvYXN0KCdUZW1hIGF0dWFsaXphZG8nLCAnb2snKTsKICAgICAgICAgIHRyeSB7IHVwZGF0ZUhvbWVTdGF0dXMoKTsgfSBjYXRjaCB7fQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGNvbnN0IHVwbG9hZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZ1VwbG9hZCcpOwogICAgICBpZiAodXBsb2FkKSB7CiAgICAgICAgdXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICBjb25zdCBmID0gZS50YXJnZXQuZmlsZXMgJiYgZS50YXJnZXQuZmlsZXNbMF07CiAgICAgICAgICBpZiAoIWYpIHJldHVybjsKICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIExTLnNldCgndW5vOmJnJywgcmVhZGVyLnJlc3VsdCk7CiAgICAgICAgICAgICAgTFMuc2V0KCd1bm86dGhlbWUnLCAnY3VzdG9tJyk7CiAgICAgICAgICAgICAgaWYgKHNlbCkgc2VsLnZhbHVlID0gJ2N1c3RvbSc7CiAgICAgICAgICAgICAgYXBwbHlUaGVtZSgpOwogICAgICAgICAgICAgIHRvYXN0KCdGdW5kbyBwZXJzb25hbGl6YWRvIHNhbHZvJywgJ29rJyk7CiAgICAgICAgICAgICAgdHJ5IHsgdXBkYXRlSG9tZVN0YXR1cygpOyB9IGNhdGNoIHt9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgeyBjb25zb2xlLmVycm9yKGVycik7IHRvYXN0KCdFcnJvIGFvIHNhbHZhciBmdW5kbycsICdlcnInKTsgfQogICAgICAgICAgfTsKICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGYpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KSgpOwoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PSDDjWNvbmVzIGlubGluZSAoZGF0YSBTVkcpID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgZnVuY3Rpb24gc3ZnSWNvbihuYW1lKXsKICAgICAgY29uc3QgY29tbW9uID0gJ3htbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iJTIzZjVmN2ZmIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCInOwogICAgICBjb25zdCBtID0gewogICAgICAgIGF0bGFzOiBgPHN2ZyAke2NvbW1vbn0+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iOSIvPjxwYXRoIGQ9Ik0zIDEyaDE4TTEyIDN2MTgiLz48cGF0aCBkPSJNNSA4YzMgMiAxMSAyIDE0IDBNNSAxNmMzLTIgMTEtMiAxNCAwIi8+PC9zdmc+YCwKICAgICAgICBub3ZhOiBgPHN2ZyAke2NvbW1vbn0+PHBhdGggZD0iTTEyIDJ2NE0xMiAxOHY0TTIgMTJoNE0xOCAxMmg0Ii8+PHBhdGggZD0iTTUuNiA1LjZsMi44IDIuOE0xNS42IDE1LjZsMi44IDIuOE0xOC40IDUuNmwtMi44IDIuOE04LjQgMTUuNmwtMi44IDIuOCIvPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiLz48L3N2Zz5gLAogICAgICAgIHZpdGFsaXM6YDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik0zIDEyaDRsMi01IDQgMTAgMi01aDYiLz48cGF0aCBkPSJNMTMgM2wtMiA0IDMgMS0yIDQiLz48L3N2Zz5gLAogICAgICAgIHB1bHNlOiBgPHN2ZyAke2NvbW1vbn0+PHBhdGggZD0iTTIgMTJoM2wyLTQgMyA4IDItNGg4Ii8+PHBhdGggZD0iTTIwIDh2LTNNMjAgMTl2LTMiLz48L3N2Zz5gLAogICAgICAgIGFydGVtaXM6YDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik0zIDEyaDEyIi8+PHBhdGggZD0iTTEzIDZsNiA2LTYgNiIvPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjkiLz48L3N2Zz5gLAogICAgICAgIHNlcmVuYTpgPHN2ZyAke2NvbW1vbn0+PHBhdGggZD0iTTEyIDIxcy02LTMuNS02LThhNCA0IDAgMCAxIDYtMyA0IDQgMCAwIDEgNiAzYzAgNC41LTYgOC02IDh6Ii8+PC9zdmc+YCwKICAgICAgICBrYW9zOiAgYDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik00IDRsNyA3LTcgNyIvPjxwYXRoIGQ9Ik0yMCA0bC03IDcgNyA3Ii8+PC9zdmc+YCwKICAgICAgICBnZW51czogYDxzdmcgJHtjb21tb259PjxyZWN0IHg9IjciIHk9IjciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgcng9IjIiLz48cGF0aCBkPSJNNyA3bDUtMyA1IDNNMTcgMTdsLTUgMy01LTMiLz48L3N2Zz5gLAogICAgICAgIGx1bWluZTpgPHN2ZyAke2NvbW1vbn0+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNCIvPjxwYXRoIGQ9Ik0xMiAydjJNMTIgMjB2Mk0yIDEyaDJNMjAgMTJoMk00LjkgNC45bDEuNCAxLjRNMTcuNyAxNy43bDEuNCAxLjRNNC45IDE5LjFsMS40LTEuNE0xNy43IDYuM2wxLjQtMS40Ii8+PC9zdmc+YCwKICAgICAgICByaGVhOiAgYDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik0xMiAzdjYiLz48Y2lyY2xlIGN4PSIxMiIgY3k9IjkiIHI9IjQiLz48cGF0aCBkPSJNMTIgMTN2MmwtMiAyTTEyIDE1bDIgMk0xMiAxN3YzIi8+PC9zdmc+YCwKICAgICAgICBzb2x1czogYDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik0xMiAzdjZNMTIgMTV2NiIvPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiLz48cGF0aCBkPSJNMTkgNWwtMyAzTTUgMTlsMy0zTTUgNWwzIDNNMTkgMTlsLTMtMyIvPjwvc3ZnPmAsCiAgICAgICAgYWlvbjogIGA8c3ZnICR7Y29tbW9ufT48cGF0aCBkPSJNNyAxMmMwLTIuMiAxLjgtNCA0LTQgMS4yIDAgMi4zLjUgMyAxLjNNMTcgMTJjMCAyLjItMS44IDQtNCA0LTEuMiAwLTIuMy0uNS0zLTEuMyIvPjxwYXRoIGQ9Ik0zIDEyaDRNMTcgMTJoNCIvPjwvc3ZnPmAsCiAgICAgICAgLy8gRXh0cmEgaWNvbnMgcHJvdmlkZWQgYnkgdGhlIHVzZXIuIFRoZXNlIGFyZSBhcHByb3hpbWF0aW9ucyBvZiB0aGUgcmVxdWVzdGVkCiAgICAgICAgLy8gYXNzZXRzIChlLmcuIGF1ZGlvLnN2ZywgYm9sdC5zdmcsIGV0Yy4pIHVzaW5nIHNpbXBsZSBsaW5lIGFydC4gVGhleQogICAgICAgIC8vIG1haW50YWluIHRoZSBzYW1lIHN0cm9rZSBjaGFyYWN0ZXJpc3RpY3MgYXMgdGhlIGV4aXN0aW5nIGljb25zLiBUbyB1c2UKICAgICAgICAvLyB0aGVtIGVsc2V3aGVyZSBpbiB0aGUgVUksIGNhbGwgc3ZnSWNvbignYXVkaW8nKSwgc3ZnSWNvbignYm9sdCcpLCBldGMuCiAgICAgICAgYXVkaW86IGA8c3ZnICR7Y29tbW9ufT48cG9seWdvbiBwb2ludHM9IjMsOSA4LDkgMTIsNSAxMiwxOSA4LDE1IDMsMTUiLz48cGF0aCBkPSJNMTUgOWMxLjUgMS41IDEuNSA0IDAgNSIvPjxwYXRoIGQ9Ik0xNyA3YzMgMyAzIDcgMCAxMCIvPjwvc3ZnPmAsCiAgICAgICAgYm9sdDogYDxzdmcgJHtjb21tb259PjxwYXRoIGQ9Ik0xMyAzTDQgMTRoN2wtMiA3IDktMTFoLTdsMy03eiIvPjwvc3ZnPmAsCiAgICAgICAgZG93bmxvYWQ6IGA8c3ZnICR7Y29tbW9ufT48cGF0aCBkPSJNMTIgM3YxMiIvPjxwYXRoIGQ9Ik02IDlsNiA2IDYtNiIvPjxwYXRoIGQ9Ik01IDE5aDE0Ii8+PC9zdmc+YCwKICAgICAgICBncmlkOiBgPHN2ZyAke2NvbW1vbn0+PHJlY3QgeD0iMyIgeT0iMyIgd2lkdGg9IjciIGhlaWdodD0iNyIvPjxyZWN0IHg9IjE0IiB5PSIzIiB3aWR0aD0iNyIgaGVpZ2h0PSI3Ii8+PHJlY3QgeD0iMyIgeT0iMTQiIHdpZHRoPSI3IiBoZWlnaHQ9IjciLz48cmVjdCB4PSIxNCIgeT0iMTQiIHdpZHRoPSI3IiBoZWlnaHQ9IjciLz48L3N2Zz5gLAogICAgICAgIGhvbWU6IGA8c3ZnICR7Y29tbW9ufT48cGF0aCBkPSJNMyA5bDktNyA5IDd2MTFhMiAyIDAgMCAxLTIgMmgtMTRhMiAyIDAgMCAxLTItMnoiLz48cG9seWxpbmUgcG9pbnRzPSI5IDIyIDkgMTIgMTUgMTIgMTUgMjIiLz48L3N2Zz5gLAogICAgICAgIGpzb246IGA8c3ZnICR7Y29tbW9ufT48cGF0aCBkPSJNNyA0Yy0yIDAtMiAyLTIgNHY4YzAgMiAwIDQgMiA0Ii8+PHBhdGggZD0iTTE3IDRjMiAwIDIgMiAyIDR2OGMwIDIgMCA0LTIgNCIvPjwvc3ZnPmAsCiAgICAgICAgJ2xvZ28tY2Fwc3VsZSc6IGA8c3ZnICR7Y29tbW9ufT48cmVjdCB4PSI0IiB5PSI3IiB3aWR0aD0iMTYiIGhlaWdodD0iMTAiIHJ4PSI1Ii8+PHBhdGggZD0iTTEyIDd2MTAiLz48L3N2Zz5gLAogICAgICAgICdsb2dvLXNlZWQtc3BsaXQnOiBgPHN2ZyAke2NvbW1vbn0+PHBhdGggZD0iTTEyIDEyYzAtNCA0LTggOC04djhjMCA0LTQgOC04IDh2LTh6Ii8+PHBhdGggZD0iTTEyIDEyYzAtNC00LTgtOC04djhjMCA0IDQgOCA4IDh2LTh6Ii8+PC9zdmc+YCwKICAgICAgICBwYXVzZTogYDxzdmcgJHtjb21tb259PjxyZWN0IHg9IjYiIHk9IjQiIHdpZHRoPSIzIiBoZWlnaHQ9IjE2Ii8+PHJlY3QgeD0iMTUiIHk9IjQiIHdpZHRoPSIzIiBoZWlnaHQ9IjE2Ii8+PC9zdmc+YCwKICAgICAgICBwbGF5OiBgPHN2ZyAke2NvbW1vbn0+PHBvbHlnb24gcG9pbnRzPSI2LDQgMjAsMTIgNiwyMCIvPjwvc3ZnPmAsCiAgICAgICAgdXBsb2FkOiBgPHN2ZyAke2NvbW1vbn0+PHBhdGggZD0iTTEyIDIxVjkiLz48cGF0aCBkPSJNNiAxNWw2LTYgNiA2Ii8+PHBhdGggZD0iTTUgNWgxNCIvPjwvc3ZnPmAsCiAgICAgICAgdXNlcjogYDxzdmcgJHtjb21tb259PjxjaXJjbGUgY3g9IjEyIiBjeT0iOCIgcj0iNCIvPjxwYXRoIGQ9Ik00IDIwYzAtNCA0LTggOC04czggNCA4IDgiLz48L3N2Zz5gLAogICAgICAgIHNwcml0ZXM6IGA8c3ZnICR7Y29tbW9ufT48L3N2Zz5gCiAgICAgIH07CiAgICAgIGNvbnN0IHJhdyA9IG1bbmFtZV0gfHwgbVsnYXRsYXMnXTsKICAgICAgcmV0dXJuICdkYXRhOmltYWdlL3N2Zyt4bWw7dXRmOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KHJhdyk7CiAgICB9CgogICAgLyogPT09PT09PT09PT09PT09PT09PT09IEFwcHMgKGVtYnV0aWRvICsgbG9jYWlzKSA9PT09PT09PT09PT09PT09PT09PT0gKi8KICAgIGNvbnN0IFJBVyA9IHsgYXBwczogW10gfTsKCiAgICAvLyBDb250cm9sZSBwYXJhIGV4aWJpciBhcGVuYXMgYXBwcyBsb2NhaXMgb3UgdG9kb3MKICAgIGxldCBzaG93T25seUxvY2FsID0gZmFsc2U7CiAgICAvLyBMaXN0YSBkZSBhcHBzIGZhdm9yaXRhZG9zIChwb3IgY2hhdmUpLiBDYXJyZWdhZGEgZG8gbG9jYWxTdG9yYWdlCiAgICBsZXQgZmF2b3JpdGVLZXlzID0gW107CiAgICB0cnkgeyBmYXZvcml0ZUtleXMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdpbmZvZG9zZTpmYXZBcHBzJykgfHwgJ1tdJykgfHwgW107IH0gY2F0Y2ggeyBmYXZvcml0ZUtleXMgPSBbXTsgfQoKICAgIC8qKgogICAgICogQWx0ZXJuYSB1bSBhcHAgbmEgbGlzdGEgZGUgZmF2b3JpdG9zLiBTYWx2YSBubyBsb2NhbFN0b3JhZ2UgZSByZS1yZW5kZXJpemEuCiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRvZ2dsZUZhdihrZXkpIHsKICAgICAgY29uc3QgaWR4ID0gZmF2b3JpdGVLZXlzLmluZGV4T2Yoa2V5KTsKICAgICAgaWYgKGlkeCA+PSAwKSB7CiAgICAgICAgZmF2b3JpdGVLZXlzLnNwbGljZShpZHgsIDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGZhdm9yaXRlS2V5cy5wdXNoKGtleSk7CiAgICAgIH0KICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2luZm9kb3NlOmZhdkFwcHMnLCBKU09OLnN0cmluZ2lmeShmYXZvcml0ZUtleXMpKTsKICAgICAgcmVuZGVyQXBwcygpOwogICAgfQogICAgLyoqIFZlcmlmaWNhIHNlIHVtIGFwcCBlc3TDoSBmYXZvcml0YWRvLiAqLwogICAgZnVuY3Rpb24gaXNGYXYoa2V5KSB7CiAgICAgIHJldHVybiBmYXZvcml0ZUtleXMuaW5jbHVkZXMoa2V5KTsKICAgIH0KICAgIGNvbnN0IGFwcHNXcmFwID0gJCgnI2FwcHNXcmFwJyksIGFwcHNDb3VudCA9ICQoJyNhcHBzQ291bnQnKTsKCiAgICBmdW5jdGlvbiBub3JtYWxpemUobGlzdCkgewogICAgICByZXR1cm4gKGxpc3QgfHwgW10pLm1hcCh4ID0+ICh7CiAgICAgICAga2V5OiB4LmtleSB8fCB4LnVybCB8fCB4LnRpdGxlIHx8IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpLAogICAgICAgIHRpdGxlOiB4LnRpdGxlIHx8IHgua2V5IHx8ICdBcHAnLAogICAgICAgIGRlc2M6IHguZGVzYyB8fCAnJywKICAgICAgICB1cmw6IFN0cmluZyh4LnVybCB8fCAnJyksCiAgICAgICAgaWNvbjogeC5pY29uIHx8ICcnLAogICAgICAgIHRhZ3M6IEFycmF5LmlzQXJyYXkoeC50YWdzKSA/IHgudGFncyA6IFtdCiAgICAgIH0pKQogICAgfQogICAgZnVuY3Rpb24gbG9jYWxzKCkgewogICAgICBsZXQgYXJyID0gW107IHRyeSB7IGFyciA9IEpTT04ucGFyc2UoTFMucmF3KCdpbmZvZG9zZTpsb2NhbHM6djEnKSB8fCAnW10nKSB9IGNhdGNoIHt9CiAgICAgIHJldHVybiBhcnIubWFwKGwgPT4gKHsga2V5OiAnbG9jYWw6JyArIGwuaWQsIHRpdGxlOiBsLm5hbWUgfHwgJ0xvY2FsJywgZGVzYzogJ0hUTUwgbG9jYWwnLCB1cmw6ICdsb2NhbDonICsgbC5pZCwgaWNvbjogJ2xvY2FsJywgdGFnczogWydsb2NhbCddIH0pKQogICAgfQogICAgZnVuY3Rpb24gZ2V0TG9jYWwoaWQpIHsKICAgICAgbGV0IGFyciA9IFtdOyB0cnkgeyBhcnIgPSBKU09OLnBhcnNlKExTLnJhdygnaW5mb2Rvc2U6bG9jYWxzOnYxJykgfHwgJ1tdJykgfSBjYXRjaCB7fQogICAgICByZXR1cm4gYXJyLmZpbmQoeCA9PiB4LmlkID09PSBpZCkgfHwgbnVsbAogICAgfQogICAgZnVuY3Rpb24gYmxvYlVSTChsb2NhbCkgeyBjb25zdCBibG9iID0gbmV3IEJsb2IoW2xvY2FsLmh0bWwgfHwgJyddLCB7IHR5cGU6ICd0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCcgfSk7IHJldHVybiBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpIH0KCiAgICAvKioKICAgICAqIEF0dWFsaXphIG9zIGNhcnTDtWVzIGRlIHN0YXR1cyBuYSBIb21lIGNvbSBpbmZvcm1hw6fDtWVzIGF0dWFpcyBzb2JyZSBhcHBzLCBzZXNzw7VlcywKICAgICAqIHByZWZlcsOqbmNpYXMgZG8gdXN1w6FyaW8gZSBhcnF1w6l0aXBvIGF0aXZvLiBDaGFtYWRvIHNlbXByZSBxdWUgbwogICAgICogY2F0w6Fsb2dvIG11ZGEsIHF1YW5kbyBzZXNzw7VlcyBzw6NvIGFiZXJ0YXMvZmVjaGFkYXMsIHF1YW5kbwogICAgICogY29uZmlndXJhw6fDtWVzIHPDo28gc2FsdmFzIG91IGFvIG5hdmVnYXIgcGFyYSBvIEhvbWUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUhvbWVTdGF0dXMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8gQXBwczogbsO6bWVybyB0b3RhbCBvdSBsb2NhaXMgc2UgZXN0aXZlciBmaWx0cmFuZG8KICAgICAgICBjb25zdCB0b3RhbCA9IG5vcm1hbGl6ZShSQVcuYXBwcykuY29uY2F0KGxvY2FscygpKS5sZW5ndGg7CiAgICAgICAgY29uc3QgbG9jYWxDb3VudCA9IGxvY2FscygpLmxlbmd0aDsKICAgICAgICBjb25zdCB0eHRBcHBzID0gc2hvd09ubHlMb2NhbCA/IChsb2NhbENvdW50ICsgJyBsb2NhbCcgKyAobG9jYWxDb3VudCA9PT0gMSA/ICcnIDogJ3MnKSkgOiAodG90YWwgKyAnIGFwcCcgKyAodG90YWwgPT09IDEgPyAnJyA6ICdzJykpOwogICAgICAgIGNvbnN0IGVsQXBwcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob21lQXBwc1N0YXR1cycpOwogICAgICAgIGlmIChlbEFwcHMpIGVsQXBwcy50ZXh0Q29udGVudCA9IHR4dEFwcHM7CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIHRyeSB7CiAgICAgICAgLy8gU2Vzc8O1ZXMgYWJlcnRhcyAoU3RhY2spCiAgICAgICAgY29uc3Qgc2VzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzdGFja1dyYXAgLnNlc3Npb24nKS5sZW5ndGg7CiAgICAgICAgY29uc3QgdHh0U2VzcyA9IHNlc3MgKyAnIHNlc3PDo28nICsgKHNlc3MgPT09IDEgPyAnJyA6ICdzJyk7CiAgICAgICAgY29uc3QgZWxTdGFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob21lU3RhY2tTdGF0dXMnKTsKICAgICAgICBpZiAoZWxTdGFjaykgZWxTdGFjay50ZXh0Q29udGVudCA9IHR4dFNlc3M7CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIHRyeSB7CiAgICAgICAgLy8gVXN1w6FyaW86IG5vbWUgKyB0ZW1hIGF0dWFsIChtYXBhKQogICAgICAgIGNvbnN0IG5hbWUgPSAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2luZm9kb3NlOnVzZXJOYW1lJykgfHwgJycpLnRyaW0oKTsKICAgICAgICBjb25zdCB0aGVtZSA9IExTLmdldCgndW5vOnRoZW1lJywgJ21lZGl1bScpOwogICAgICAgIGNvbnN0IHRoZW1lTGFiZWwgPSB7ICdkZWZhdWx0JzogJ3BhZHLDo28nLCAnbWVkaXVtJzogJ2NpbnphJywgJ2N1c3RvbSc6ICdwZXJzb25hbGl6YWRvJyB9W3RoZW1lXSB8fCB0aGVtZTsKICAgICAgICBsZXQgdHh0VXNlciA9IG5hbWUgfHwgJ1VzdcOhcmlvJzsKICAgICAgICB0eHRVc2VyICs9ICcgwrcgJyArIHRoZW1lTGFiZWw7CiAgICAgICAgY29uc3QgZWxVc2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hvbWVVc2VyU3RhdHVzJyk7CiAgICAgICAgaWYgKGVsVXNlcikgZWxVc2VyLnRleHRDb250ZW50ID0gdHh0VXNlcjsKICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgdHJ5IHsKICAgICAgICAvLyBBcnF1w6l0aXBvIGF0aXZvOiBvYnTDqW0gbyBub21lIHNlbSBleHRlbnPDo28KICAgICAgICBjb25zdCBzZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJjaC1zZWxlY3QnKTsKICAgICAgICBsZXQgYXJjaE5hbWUgPSAnJzsKICAgICAgICBpZiAoc2VsICYmIHNlbC5vcHRpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGNvbnN0IG9wdCA9IHNlbC5vcHRpb25zW3NlbC5zZWxlY3RlZEluZGV4XSB8fCBudWxsOwogICAgICAgICAgaWYgKG9wdCkgYXJjaE5hbWUgPSBvcHQudGV4dENvbnRlbnQucmVwbGFjZSgvXC5odG1sJC9pLCAnJyk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGVsQXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob21lQXJjaFN0YXR1cycpOwogICAgICAgIGlmIChlbEFyY2gpIGVsQXJjaC50ZXh0Q29udGVudCA9IGFyY2hOYW1lIHx8ICdOZW5odW0nOwogICAgICB9IGNhdGNoIChlKSB7fQogICAgfQoKICAgIGZ1bmN0aW9uIGFwcEljb25Gb3IoYSl7CiAgICAgIGlmKCFhLmljb24pIHJldHVybiBzdmdJY29uKCdhdGxhcycpOwogICAgICBpZigvXihhdGxhc3xub3ZhfHZpdGFsaXN8cHVsc2V8YXJ0ZW1pc3xzZXJlbmF8a2Fvc3xnZW51c3xsdW1pbmV8cmhlYXxzb2x1c3xhaW9ufGxvY2FsKSQvLnRlc3QoYS5pY29uKSkgcmV0dXJuIHN2Z0ljb24oYS5pY29uKTsKICAgICAgcmV0dXJuIGEuaWNvbjsgLy8gY2FtaW5obyBleHRlcm5vCiAgICB9CgogICAgZnVuY3Rpb24gY2FyZEFwcChhKSB7CiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGVsLmNsYXNzTmFtZSA9ICdhcHAtY2FyZCBmeC10cmFucyBmeC1saWZ0JzsKICAgICAgLy8gQm90w6NvIGRlIGZhdm9yaXRvIChlc3RyZWxhKS4gQXBhcmVjZSBubyBjYW50byBzdXBlcmlvciBkaXJlaXRvCiAgICAgIGNvbnN0IGZhdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyBmYXYuY2xhc3NOYW1lID0gJ2Zhdi1idG4nOwogICAgICBjb25zdCBmYXZJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKICAgICAgZmF2SW1nLmFsdCA9ICdGYXZvcml0byc7CiAgICAgIC8vIFVzZSDDrWNvbmUgbG9jYWwgcGFyYSBmYXZvcml0bzsgZXZpdGEgZGVwZW5kZXIgZGUgQ0ROCiAgICAgIGZhdkltZy5zcmMgPSAnaWNvbnMvc3Rhci5zdmcnOwogICAgICBmYXYuYXBwZW5kQ2hpbGQoZmF2SW1nKTsKICAgICAgLy8gTWFycXVlIGNvbW8gZmF2b3JpdGFkbyBzZSBhIGNoYXZlIGVzdGl2ZXIgbmEgbGlzdGEKICAgICAgaWYgKGlzRmF2KGEua2V5KSkgZmF2LmNsYXNzTGlzdC5hZGQoJ2ZhdicpOwogICAgICBmYXYub25jbGljayA9IChlKSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHRvZ2dsZUZhdihhLmtleSk7IH07CiAgICAgIGVsLmFwcGVuZENoaWxkKGZhdik7CiAgICAgIGNvbnN0IGljID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGljLmNsYXNzTmFtZSA9ICdhcHAtaWNvbic7CiAgICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOyBpbWcuYWx0ID0gJyc7IGltZy53aWR0aCA9IDI0OyBpbWcuaGVpZ2h0ID0gMjQ7IGltZy5zcmMgPSBhcHBJY29uRm9yKGEpOyBpYy5hcHBlbmRDaGlsZChpbWcpOwogICAgICBjb25zdCBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IG1ldGEuc3R5bGUuZmxleCA9ICcxJzsKICAgICAgY29uc3QgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyB0LmNsYXNzTmFtZSA9ICdhcHAtdGl0bGUnOyB0LnRleHRDb250ZW50ID0gYS50aXRsZTsKICAgICAgY29uc3QgZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBkLmNsYXNzTmFtZSA9ICdtdXQnOyBkLnRleHRDb250ZW50ID0gYS5kZXNjIHx8IGEudXJsOwogICAgICBjb25zdCBvcGVuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IG9wZW4uY2xhc3NOYW1lID0gJ2J0biBmeC10cmFucyBmeC1wcmVzcyByaW5nJzsgb3Blbi50ZXh0Q29udGVudCA9ICdBYnJpcic7CiAgICAgIGNvbnN0IHJpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgcmlwLmNsYXNzTmFtZSA9ICdyaXBwbGUnOyBvcGVuLmFwcGVuZENoaWxkKHJpcCk7IGFkZFJpcHBsZShvcGVuKTsKICAgICAgb3Blbi5vbmNsaWNrID0gKCkgPT4gb3BlbkFwcChhKTsKICAgICAgbWV0YS5hcHBlbmRDaGlsZCh0KTsgbWV0YS5hcHBlbmRDaGlsZChkKTsgbWV0YS5hcHBlbmRDaGlsZChvcGVuKTsKICAgICAgZWwuYXBwZW5kQ2hpbGQoaWMpOyBlbC5hcHBlbmRDaGlsZChtZXRhKTsKICAgICAgcmV0dXJuIGVsCiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyQXBwcygpIHsKICAgICAgLy8gQnVzcXVlIHZhbG9yZXMgZGUgYnVzY2EgZSBvcmRlbmHDp8OjbyBhcGVuYXMgc2Ugb3MgY2FtcG9zIGV4aXN0aXJlbSAoZXZpdGEgZXJyb3Mgc2Ugb2N1bHRvcykKICAgICAgY29uc3Qgc2VhcmNoRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwU2VhcmNoJyk7CiAgICAgIGNvbnN0IHNvcnRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBTb3J0Jyk7CiAgICAgIGNvbnN0IHEgPSBzZWFyY2hFbCA/IChzZWFyY2hFbC52YWx1ZSB8fCAnJykudG9Mb3dlckNhc2UoKSA6ICcnOwogICAgICBjb25zdCBtb2RlID0gc29ydEVsID8gc29ydEVsLnZhbHVlIDogJ2F6JzsKICAgICAgLy8gQ29tYmluZSBhcHBzIGVtYnV0aWRvcyBlIGxvY2FpcwogICAgICBsZXQgTCA9IG5vcm1hbGl6ZShSQVcuYXBwcykuY29uY2F0KGxvY2FscygpKTsKICAgICAgLy8gRmlsdHJhciBhcGVuYXMgbG9jYWlzIHNlIGF0aXZhZG8KICAgICAgaWYgKHNob3dPbmx5TG9jYWwpIHsKICAgICAgICBMID0gTC5maWx0ZXIoYSA9PiBTdHJpbmcoYS51cmwgfHwgJycpLnN0YXJ0c1dpdGgoJ2xvY2FsOicpKTsKICAgICAgfQogICAgICAvLyBBcGxpY2FyIGJ1c2NhIChtYW50ZW5kbyBjb21wYXRpYmlsaWRhZGUgc2UgbyB1c3XDoXJpbyBhaW5kYSBwb3NzdWlyIG8gY2FtcG8pCiAgICAgIGlmIChxKSB7CiAgICAgICAgTCA9IEwuZmlsdGVyKGEgPT4gKGEudGl0bGUgKyAnICcgKyBhLmRlc2MgKyAnICcgKyBhLmtleSArICcgJyArIGEudXJsICsgJyAnICsgKGEudGFncyB8fCBbXSkuam9pbignICcpKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEpKTsKICAgICAgfQogICAgICAvLyBPcmRlbmFyOiBmYXZvcml0b3MgcHJpbWVpcm8sIGRlcG9pcyB0w610dWxvIEEtWiBvdSBaLUEgY29uZm9ybWUgbyBzZWxlY3QgKHBhZHLDo28gQS1aKQogICAgICBMLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICBjb25zdCBmYXZBID0gaXNGYXYoYS5rZXkpOyBjb25zdCBmYXZCID0gaXNGYXYoYi5rZXkpOwogICAgICAgIGlmIChmYXZBICE9PSBmYXZCKSByZXR1cm4gZmF2QiAtIGZhdkE7IC8vIHRydWU9MSwgZmFsc2U9MCA9PiBmYXZvcml0b3Mgbm8gdG9wbwogICAgICAgIGNvbnN0IGRpciA9IG1vZGUgPT09ICd6YScgPyAtMSA6IDE7CiAgICAgICAgcmV0dXJuIGRpciAqIFN0cmluZyhhLnRpdGxlIHx8ICcnKS5sb2NhbGVDb21wYXJlKGIudGl0bGUgfHwgJycpOwogICAgICB9KTsKICAgICAgYXBwc1dyYXAuaW5uZXJIVE1MID0gJyc7CiAgICAgIEwuZm9yRWFjaChhID0+IHsKICAgICAgICBjb25zdCBjYXJkID0gY2FyZEFwcChhKTsKICAgICAgICBhcHBzV3JhcC5hcHBlbmRDaGlsZChjYXJkKTsKICAgICAgfSk7CiAgICAgIGFwcHNDb3VudC50ZXh0Q29udGVudCA9IEwubGVuZ3RoICsgJyBhcHBzJzsKICAgICAgLy8gUmVhcGxpY2FyIMOtY29uZXMgYXDDs3MgYWRpY2lvbmFyIG5vdm9zIGNhcmRzIChnYXJhbnRlIHF1ZSBhcyBlc3RyZWxhcyBlIMOtY29uZXMgZGUgYXBwcyBjYXJyZWd1ZW0pCiAgICAgIHRyeSB7IGFwcGx5SWNvbnMoKTsgfSBjYXRjaCB7fQogICAgICAvLyBOb3RpZmlxdWUgbyBSZXZvIGRlIHF1ZSBvcyBhcHBzIG11ZGFyYW0sIHNlIGVzdGl2ZXIgYXRpdm8KICAgICAgbWF5YmVTZW5kQXBwc1RvUmV2bygpOwogICAgICAvLyBBdHVhbGl6ZSBvIHBhaW5lbCBkZSBzdGF0dXMgbmEgaG9tZSBjb20gbyBub3ZvIG7Dum1lcm8gZGUgYXBwcwogICAgICB0cnkgeyB1cGRhdGVIb21lU3RhdHVzKCk7IH0gY2F0Y2gge30KICAgIH0KCiAgICAoZnVuY3Rpb24gbG9hZEVtYmVkZGVkQXBwcygpewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJhdyA9IEpTT04ucGFyc2UoJCgnI0FQUFNfSlNPTicpLnRleHRDb250ZW50IHx8ICd7fScpOwogICAgICAgIFJBVy5hcHBzID0gQXJyYXkuaXNBcnJheShyYXcuYXBwcykgPyByYXcuYXBwcyA6IChBcnJheS5pc0FycmF5KHJhdykgPyByYXcgOiBbXSk7CiAgICAgIH0gY2F0Y2ggeyBSQVcuYXBwcyA9IFtdIH0KICAgICAgcmVuZGVyQXBwcygpOwogICAgICAvLyBTZW1wcmUgZW52aWUgbyBjYXTDoWxvZ28gYXR1YWxpemFkbyBhbyBpZnJhbWUgZG8gUmV2byBhcMOzcyBjYXJyZWdhciBvcyBhcHBzIGVtYnV0aWRvcy4KICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2b0VtYmVkJyk7CiAgICAgICAgaWYgKGlmcmFtZSkgewogICAgICAgICAgY29uc3QgYXBwcyA9IFJBVyAmJiBBcnJheS5pc0FycmF5KFJBVy5hcHBzKSA/IFJBVy5hcHBzIDogW107CiAgICAgICAgICBjb25zdCBzZW5kID0gKCkgPT4geyBpZiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpIGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKHsgdHlwZTogJ2FwcHMnLCBhcHBzIH0sICcqJyk7IH07CiAgICAgICAgICAvLyBFbnZpZSBhcMOzcyBwZXF1ZW5vIGF0cmFzbyBwYXJhIGdhcmFudGlyIHF1ZSBvIGlmcmFtZSBlc3RlamEgcHJvbnRvCiAgICAgICAgICBzZXRUaW1lb3V0KHNlbmQsIDEwMCk7CiAgICAgICAgICAvLyBFIHRhbWLDqW0gcXVhbmRvIG8gaWZyYW1lIHRlcm1pbmFyIGRlIGNhcnJlZ2FyCiAgICAgICAgICBpZnJhbWUucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZCcsIGlmcmFtZS5fc2VuZEFwcHNFbWJlZGRlZCk7CiAgICAgICAgICBpZnJhbWUuX3NlbmRBcHBzRW1iZWRkZWQgPSBzZW5kOwogICAgICAgICAgaWZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBzZW5kLCB7IG9uY2U6IHRydWUgfSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoKGUpIHsgY29uc29sZS53YXJuKCdGYWxoYSBhbyBwb3N0TWVzc2FnZSBhcHBzIGFww7NzIGVtYmVkOicsIGUpOyB9CiAgICB9KSgpOwoKICAgIC8vIExvY2FpcwogICAgJCgnI2J0bkltcG9ydCcpLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7CiAgICAgIGNvbnN0IGZzID0gQXJyYXkuZnJvbSgkKCcjZmlsZUxvY2FsJykuZmlsZXMgfHwgW10pOyBpZiAoIWZzLmxlbmd0aCkgcmV0dXJuOwogICAgICBjb25zdCB0YXNrcyA9IGZzLm1hcChmID0+IG5ldyBQcm9taXNlKHJlcyA9PiB7IGNvbnN0IHIgPSBuZXcgRmlsZVJlYWRlcigpOyByLm9ubG9hZCA9ICgpID0+IHJlcyh7IGlkOiAnbF8nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiksIG5hbWU6IGYubmFtZS5yZXBsYWNlKC9cLihodG1sP3x0eHQpJC9pLCAnJyksIGh0bWw6IFN0cmluZyhyLnJlc3VsdCB8fCAnJyksIHRzOiBEYXRlLm5vdygpIH0pOyByLnJlYWRBc1RleHQoZikgfSkpOwogICAgICBjb25zdCBsaXN0ID0gYXdhaXQgUHJvbWlzZS5hbGwodGFza3MpOyBjb25zdCBjdXIgPSBKU09OLnBhcnNlKExTLnJhdygnaW5mb2Rvc2U6bG9jYWxzOnYxJykgfHwgJ1tdJyk7IGxpc3QuZm9yRWFjaCh4ID0+IGN1ci51bnNoaWZ0KHgpKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2luZm9kb3NlOmxvY2Fsczp2MScsIEpTT04uc3RyaW5naWZ5KGN1cikpOyByZW5kZXJBcHBzKCk7IHRvYXN0KCdIVE1McyBsb2NhaXMgYWRpY2lvbmFkb3MnLCAnb2snKTsKICAgIH07CiAgICAkKCcjYnRuRXhwb3J0Jykub25jbGljayA9ICgpID0+IHsgY29uc3QgZGF0YSA9IHsgdjogMSwgd2hlbjogRGF0ZS5ub3coKSwgaXRlbXM6IEpTT04ucGFyc2UoTFMucmF3KCdpbmZvZG9zZTpsb2NhbHM6djEnKSB8fCAnW10nKSB9OyBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyBhLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKV0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pKTsgYS5kb3dubG9hZCA9ICdsb2NhbHNfcGFjay5qc29uJzsgYS5jbGljaygpOyB9OwogICAgJCgnI2J0bkNsZWFyJykub25jbGljayA9ICgpID0+IHsgaWYgKGNvbmZpcm0oJ0xpbXBhciBIVE1McyBsb2NhaXMgc2Fsdm9zPycpKSB7IGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpbmZvZG9zZTpsb2NhbHM6djEnKTsgcmVuZGVyQXBwcygpOyB0b2FzdCgnTG9jYWlzIGxpbXBvcycsICd3YXJuJyk7IH0gfTsKCiAgICAvLyBBbHRlcm5hIGV4aWJpw6fDo28gZGUgYXBwcyBsb2NhaXMvYXBlbmFzIGxvY2FpcwogICAgdHJ5IHsKICAgICAgY29uc3QgYnRuVG9nZ2xlTG9jYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuVG9nZ2xlTG9jYWwnKTsKICAgICAgaWYgKGJ0blRvZ2dsZUxvY2FsKSB7CiAgICAgICAgYnRuVG9nZ2xlTG9jYWwub25jbGljayA9ICgpID0+IHsKICAgICAgICAgIHNob3dPbmx5TG9jYWwgPSAhc2hvd09ubHlMb2NhbDsKICAgICAgICAgIC8vIEF0dWFsaXplIG8gdGV4dG8gZG8gYm90w6NvIGNvbmZvcm1lIG8gbW9kbwogICAgICAgICAgYnRuVG9nZ2xlTG9jYWwuZmlyc3RDaGlsZCAmJiAoYnRuVG9nZ2xlTG9jYWwuZmlyc3RDaGlsZC5ub2RlVmFsdWUgPSBzaG93T25seUxvY2FsID8gJ01vc3RyYXIgVG9kb3MnIDogJ01vc3RyYXIgTG9jYWlzJyk7CiAgICAgICAgICByZW5kZXJBcHBzKCk7CiAgICAgICAgfTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLndhcm4oJ0ZhbGhhIGFvIGFzc29jaWFyIGJ0blRvZ2dsZUxvY2FsOicsIGUpOyB9CgogICAgLyogPT09PT09PT09PT09PT09PT09PT09IFN0YWNrID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgY29uc3Qgc3RhY2tXcmFwID0gJCgnI3N0YWNrV3JhcCcpLCBkb2NrID0gJCgnI2RvY2snKTsKICAgIGZ1bmN0aW9uIGJhZGdlKGl0ZW0pIHsgY29uc3QgYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyBiLmNsYXNzTmFtZSA9ICdiYWRnZSBmeC10cmFucyBmeC1wcmVzcyByaW5nJzsgYi50ZXh0Q29udGVudCA9IGl0ZW0udGl0bGUgfHwgJ0FwcCc7IGIudGl0bGUgPSAnUmVhYnJpciAnICsgKGl0ZW0udGl0bGUgfHwgJ0FwcCcpOyBjb25zdCBycCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgcnAuY2xhc3NOYW1lID0gJ3JpcHBsZSc7IGIuYXBwZW5kQ2hpbGQocnApOyBhZGRSaXBwbGUoYik7IGIub25jbGljayA9ICgpID0+IHsgY29uc3QgcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNpZD0iJyArIGl0ZW0uc2lkICsgJyJdJyk7IGlmIChzKSB7IHMuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSk7IHMuY2xhc3NMaXN0LnJlbW92ZSgnbWluJyk7IH0gfTsgcmV0dXJuIGIgfQogICAgZnVuY3Rpb24gdXBkYXRlRG9jaygpIHsKICAgICAgZG9jay5pbm5lckhUTUwgPSAnJzsKICAgICAgJCQoJy5zZXNzaW9uJykuZm9yRWFjaChzID0+IHsKICAgICAgICBjb25zdCBtZXRhID0gSlNPTi5wYXJzZShzLmRhdGFzZXQubWV0YSB8fCAne30nKTsKICAgICAgICBkb2NrLmFwcGVuZENoaWxkKGJhZGdlKHsgdGl0bGU6IG1ldGEudGl0bGUsIHNpZDogcy5kYXRhc2V0LnNpZCB9KSkKICAgICAgfSk7CiAgICAgIC8vIEF0dWFsaXplIG8gc3RhdHVzIGRlIHNlc3PDtWVzIG5hIGhvbWUKICAgICAgdHJ5IHsgdXBkYXRlSG9tZVN0YXR1cygpOyB9IGNhdGNoIHt9CiAgICB9CiAgICBmdW5jdGlvbiBvcGVuQXBwKGEpIHsKICAgICAgY29uc3Qgc2lkID0gJ3NfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpOwogICAgICBjb25zdCBpc0xvY2FsID0gU3RyaW5nKGEudXJsIHx8ICcnKS5zdGFydHNXaXRoKCdsb2NhbDonKTsgY29uc3QgbHIgPSBpc0xvY2FsID8gZ2V0TG9jYWwoU3RyaW5nKGEudXJsKS5zbGljZSg2KSkgOiBudWxsOyBjb25zdCB1cmwgPSBsciA/IGJsb2JVUkwobHIpIDogYS51cmw7CiAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgY2FyZC5jbGFzc05hbWUgPSAnc2Vzc2lvbiBmeC10cmFucyBmeC1saWZ0JzsgY2FyZC5kYXRhc2V0LnNpZCA9IHNpZDsgY2FyZC5kYXRhc2V0Lm1ldGEgPSBKU09OLnN0cmluZ2lmeSh7IHRpdGxlOiBhLnRpdGxlIHx8ICdBcHAnLCB1cmw6IGEudXJsIHx8ICcnIH0pOwogICAgICBjYXJkLmlubmVySFRNTCA9IGAKICAgICAgICA8ZGl2IGNsYXNzPSJoZHIiPgogICAgICAgICAgPGRpdiBjbGFzcz0idGl0bGUiPiR7KGEudGl0bGUgfHwgJ0FwcCcpfTwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0idG9vbHMiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gcmluZyBmeC10cmFucyBmeC1wcmVzcyIgZGF0YS1hY3Q9Im1pbiIgdGl0bGU9Ik1pbmltaXphciI+CiAgICAgICAgICAgICAgPGltZyBkYXRhLWljb249Im1pbnVzIiBhbHQ9Ik1pbmltaXphciIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0Ij4KICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gcmluZyBmeC10cmFucyBmeC1wcmVzcyIgZGF0YS1hY3Q9InJlZiIgdGl0bGU9IlJlY2FycmVnYXIiPgogICAgICAgICAgICAgIDxpbWcgZGF0YS1pY29uPSJhcnJvdy1yb3RhdGUtcmlnaHQiIGFsdD0iUmVjYXJyZWdhciIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0Ij4KICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icmlwcGxlIj48L3NwYW4+CiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gcmluZyBmeC10cmFucyBmeC1wcmVzcyIgZGF0YS1hY3Q9ImNsb3NlIiB0aXRsZT0iRmVjaGFyIj4KICAgICAgICAgICAgICA8aW1nIGRhdGEtaWNvbj0ieG1hcmsiIGFsdD0iRmVjaGFyIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPgogICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJyaXBwbGUiPjwvc3Bhbj4KICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8aWZyYW1lIHNyYz0iJHt1cmwgfHwgJ2Fib3V0OmJsYW5rJ30iIGFsbG93PSJhdXRvcGxheTsgY2xpcGJvYXJkLXJlYWQ7IGNsaXBib2FyZC13cml0ZTsgcGljdHVyZS1pbi1waWN0dXJlOyBmdWxsc2NyZWVuIj48L2lmcmFtZT5gOwogICAgICAvLyBQcmVwZW5kIHRoZSBzZXNzaW9uIGNhcmQgYW5kIGFwcGx5IGljb25zIGZvciBkeW5hbWljIGJ1dHRvbnMKICAgICAgc3RhY2tXcmFwLnByZXBlbmQoY2FyZCk7CiAgICAgIGFwcGx5SWNvbnMoKTsKICAgICAgY2FyZC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hY3Q9bWluXScpLm9uY2xpY2sgPSAoKSA9PiB7IGNhcmQuY2xhc3NMaXN0LnRvZ2dsZSgnbWluJyk7IHVwZGF0ZURvY2soKTsgfTsKICAgICAgY2FyZC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hY3Q9cmVmXScpLm9uY2xpY2sgPSAoKSA9PiB7IGNvbnN0IGZyID0gY2FyZC5xdWVyeVNlbGVjdG9yKCdpZnJhbWUnKTsgdHJ5IHsgZnIuY29udGVudFdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSB9IGNhdGNoIHsgZnIuc3JjID0gZnIuc3JjIH0gfTsKICAgICAgY2FyZC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hY3Q9Y2xvc2VdJykub25jbGljayA9ICgpID0+IHsgY2FyZC5yZW1vdmUoKTsgdXBkYXRlRG9jaygpOyB9OwogICAgICBpZiAoJCgnI29wZW5JbnNpZGUnKS5jaGVja2VkKSBuYXYoJ3N0YWNrJyk7IHVwZGF0ZURvY2soKTsgdG9hc3QoJ0FwcCBhYmVydG86ICcgKyAoYS50aXRsZSB8fCAnQXBwJyksICdvaycpOwogICAgfQogICAgJCgnI2J0bkNsb3NlQWxsJykub25jbGljayA9ICgpID0+IHsgaWYgKCFjb25maXJtKCdGZWNoYXIgdG9kYXMgYXMgc2Vzc8O1ZXMgYWJlcnRhcz8nKSkgcmV0dXJuOyAkJCgnLnNlc3Npb24nKS5mb3JFYWNoKHMgPT4gcy5yZW1vdmUoKSk7IHVwZGF0ZURvY2soKTsgdG9hc3QoJ1RvZGFzIGFzIHNlc3PDtWVzIGZlY2hhZGFzJywgJ3dhcm4nKTsgfTsKCiAgICAvKiA9PT09PT09PT09PT09PT09PT09PT0gQXJjaGV0eXBlcyAoQ2VudHJhbCBDaXJjbGUpID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgYXJjaExpc3QgPSBbCiAgICAgICAgJ2x1eGFyYS5odG1sJywKICAgICAgICAncmhlYS5odG1sJywKICAgICAgICAnYWlvbi5odG1sJywKICAgICAgICAnYXRsYXMuaHRtbCcsCiAgICAgICAgJ25vdmEuaHRtbCcsCiAgICAgICAgJ2dlbnVzLmh0bWwnLAogICAgICAgICdsdW1pbmUuaHRtbCcsCiAgICAgICAgJ2thaW9uLmh0bWwnLAogICAgICAgICdrYW9zLmh0bWwnLAogICAgICAgICdob3J1cy5odG1sJywKICAgICAgICAnZWx5c2hhLmh0bWwnCiAgICAgIF07CiAgICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcmNoLXNlbGVjdCcpOwogICAgICBjb25zdCBmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcmNoLWZyYW1lJyk7CiAgICAgIGNvbnN0IGZhZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJjaC1mYWRlQ292ZXInKTsKICAgICAgZnVuY3Rpb24gcG9wdWxhdGUoKSB7CiAgICAgICAgc2VsZWN0LmlubmVySFRNTCA9ICcnOwogICAgICAgIGFyY2hMaXN0LmZvckVhY2gobmFtZSA9PiB7CiAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICAgIG9wdC52YWx1ZSA9IG5hbWU7CiAgICAgICAgICBvcHQudGV4dENvbnRlbnQgPSBuYW1lOwogICAgICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gc2V0U3JjQnlJbmRleChpZHgpIHsKICAgICAgICBpZiAoIWFyY2hMaXN0Lmxlbmd0aCkgcmV0dXJuOwogICAgICAgIGNvbnN0IG4gPSAoaWR4ICsgYXJjaExpc3QubGVuZ3RoKSAlIGFyY2hMaXN0Lmxlbmd0aDsKICAgICAgICBzZWxlY3Quc2VsZWN0ZWRJbmRleCA9IG47CiAgICAgICAgY29uc3QgZmlsZSA9IGFyY2hMaXN0W25dOwogICAgICAgIGZyYW1lLnNyYyA9ICcuL2FyY2hldHlwZXMvJyArIGZpbGU7CiAgICAgICAgLy8gUHJvbnVuY2lhIG8gbm9tZSBkbyBhcnF1w6l0aXBvIHNlbXByZSBxdWUgZm9yIHNlbGVjaW9uYWRvCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGJhc2UgPSBmaWxlLnJlcGxhY2UoL1wuaHRtbCQvaSwgJycpOwogICAgICAgICAgc3BlYWtBcmNoZXR5cGUoYmFzZSk7CiAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICAvLyBBdHVhbGl6YSBhcyBpbmZvcm1hw6fDtWVzIGRhIEhvbWUgKGNhcnTDtWVzKSBxdWFuZG8gbyBhcnF1w6l0aXBvIG11ZGEKICAgICAgICB0cnkgewogICAgICAgICAgdXBkYXRlSG9tZVN0YXR1cygpOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIH0KICAgICAgbGV0IGN1cnJlbnQgPSAwOwogICAgICBwb3B1bGF0ZSgpOwogICAgICBpZiAoYXJjaExpc3QubGVuZ3RoKSBzZXRTcmNCeUluZGV4KDApOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJjaC1wcmV2JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgY3VycmVudCA9IChjdXJyZW50IC0gMSArIGFyY2hMaXN0Lmxlbmd0aCkgJSBhcmNoTGlzdC5sZW5ndGg7CiAgICAgICAgZmFkZS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBzZXRTcmNCeUluZGV4KGN1cnJlbnQpOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBmYWRlLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKSwgMjAwKTsKICAgICAgICB9LCAxNDApOwogICAgICB9KTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FyY2gtbmV4dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGN1cnJlbnQgPSAoY3VycmVudCArIDEpICUgYXJjaExpc3QubGVuZ3RoOwogICAgICAgIGZhZGUuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgc2V0U3JjQnlJbmRleChjdXJyZW50KTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZmFkZS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JyksIDIwMCk7CiAgICAgICAgfSwgMTQwKTsKICAgICAgfSk7CiAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7CiAgICAgICAgY3VycmVudCA9IHNlbGVjdC5zZWxlY3RlZEluZGV4OwogICAgICAgIGZhZGUuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgc2V0U3JjQnlJbmRleChjdXJyZW50KTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZmFkZS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JyksIDIwMCk7CiAgICAgICAgfSwgMTQwKTsKICAgICAgfSk7CiAgICB9KSgpOwoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PSBDdXN0b20gQ1NTICYgVm9pY2VzOiBFdmVudCBIYW5kbGVycyA9PT09PT09PT09PT09PT09PT09PT0gKi8KICAgIC8vIEFwbGljYXIgQ1NTIHBlcnNvbmFsaXphZG8gc2Fsdm8gbm8gY2FycmVnYW1lbnRvIGluaWNpYWwKICAgIHRyeSB7IGFwcGx5Q1NTKCk7IH0gY2F0Y2ggKGUpIHt9CiAgICAvLyBJbmljaWFsaXphciB2b3plcyBuYSBhYmEgQnJhaW4KICAgIHRyeSB7IGluaXRWb2ljZXMoKTsgfSBjYXRjaCAoZSkge30KICAgIC8vIEV4aWJpciBzYXVkYcOnw6NvIGluaWNpYWwgc2UgYXBsaWPDoXZlbAogICAgdHJ5IHsgd2VsY29tZSgpOyB9IGNhdGNoIChlKSB7fQogICAgLy8gQ29uZWN0YXIgYm90w7VlcyBkZSBDU1MgcGVyc29uYWxpemFkbwogICAgY29uc3QgYnRuQXBwbHlDU1MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlDU1MnKTsKICAgIGNvbnN0IGJ0bkNsZWFyQ1NTID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyQ1NTJyk7CiAgICBjb25zdCBidG5Eb3dubG9hZENTUyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb3dubG9hZENTUycpOwogICAgaWYgKGJ0bkFwcGx5Q1NTKSB7CiAgICAgIGJ0bkFwcGx5Q1NTLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nzc0N1c3RvbScpOwogICAgICAgIGNvbnN0IGNzcyA9ICh0ZXh0YXJlYSAmJiB0ZXh0YXJlYS52YWx1ZSB8fCAnJykudHJpbSgpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdpbmZvZG9zZTpjc3NDdXN0b20nLCBjc3MpOwogICAgICAgIGFwcGx5Q1NTKCk7CiAgICAgICAgdG9hc3QoJ0NTUyBhcGxpY2FkbycsICdvaycpOwogICAgICB9KTsKICAgIH0KICAgIGlmIChidG5DbGVhckNTUykgewogICAgICBidG5DbGVhckNTUy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnaW5mb2Rvc2U6Y3NzQ3VzdG9tJyk7CiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3NzQ3VzdG9tJyk7CiAgICAgICAgaWYgKHRleHRhcmVhKSB0ZXh0YXJlYS52YWx1ZSA9ICcnOwogICAgICAgIGFwcGx5Q1NTKCk7CiAgICAgICAgdG9hc3QoJ0NTUyByZW1vdmlkbycsICd3YXJuJyk7CiAgICAgIH0pOwogICAgfQogICAgaWYgKGJ0bkRvd25sb2FkQ1NTKSB7CiAgICAgIGJ0bkRvd25sb2FkQ1NTLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGNvbnN0IGNzcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdpbmZvZG9zZTpjc3NDdXN0b20nKSB8fCAnJzsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2Nzc10sIHsgdHlwZTogJ3RleHQvY3NzJyB9KTsKICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgYS5kb3dubG9hZCA9ICdjdXN0b20uY3NzJzsKICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZiksIDUwMCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PSBJbml0ID09PT09PT09PT09PT09PT09PT09PSAqLwogICAgJCQoJ2J1dHRvbicpLmZvckVhY2goYWRkUmlwcGxlKTsKICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+";
function legacyBlobURL() {
  try {
    const bytes = atob(LEGACY_B64);
    const arr = new Uint8Array(bytes.length);
    for (let i=0; i<bytes.length; i++) arr[i] = bytes.charCodeAt(i);
    const blob = new Blob([arr], {type: "text/html"});
    return URL.createObjectURL(blob);
  } catch (e) {
    console.error("Falha para montar Blob Legacy:", e);
    return null;
  }
}

// Expor no window para uso no apps.json inline
window.__legacyUrl = legacyBlobURL();


// ====== apps.json fallback (inline) ======
async function loadAppsInlineFallback() {
  const groups = {
    "Universal": [
      {
        "key": "legacy_universal",
        "title": "Universal Legacy",
        "desc": "Versão unificada (arquivo enviado) rodando dentro do Hub",
        "url": (window.__legacyUrl || "about:blank"),
        "icon": "icons/others/hub_apps.svg"
      }
    ]
  };
  groupsWrap.innerHTML='';
  for(const [n,items] of Object.entries(groups)){
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">${n.replaceAll('_',' ')}</div><div class=muted>${items.length} apps</div></div><div class=appsGrid></div>`;
    const list=card.querySelector('.appsGrid');
    items.forEach(app=>{
      const row=document.createElement('div');
      row.className='appRow';
      const icon=app.icon||'icons/others/hub_apps.svg';
      row.innerHTML=`<img src="${icon}" onerror="this.replaceWith(svgApps(32))" alt="">
        <div style="flex:1;min-width:0">
          <div style="font-weight:700">${app.title||app.key}</div>
          <div class="muted" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis" title="${app.desc||''}">${app.desc||''}</div>
        </div>
        <div style="display:flex;gap:10px">
          <button class="btn star" data-key="${"legacy_universal"}" data-on="${false}">★</button>
          <button class="btn pri" onclick="openSession('${"legacy_universal"}','${"Universal Legacy"}', (window.__legacyUrl||'about:blank'), '${icon}')">Abrir</button>
        </div>`;
      list.appendChild(row);
    });
    groupsWrap.appendChild(card);
  }
  renderFavorites();
  log('apps.json inline (fallback) carregado');
}

// Hook na loadApps original: se falhar, usa fallback
const _origLoadApps = loadApps;
loadApps = async function() {
  try {
    await _origLoadApps();
    // Se falhou, a UI já mostra erro; detecte e aplique fallback:
    if (groupsWrap.textContent.includes('Falha ao carregar apps/apps.json')) {
      await loadAppsInlineFallback();
    }
  } catch (e) {
    await loadAppsInlineFallback();
  }
};

// Autoabrir o Legacy na inicialização
window.addEventListener('load', () => {
  if (window.__legacyUrl) {
    openSession('legacy_universal', 'Universal Legacy', window.__legacyUrl, 'icons/others/hub_apps.svg');
  } else {
    log('Sem URL legacy');
  }
});

</script>
</body>
</html>