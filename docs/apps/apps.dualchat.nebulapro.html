<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>DualChat ‚Ä¢ Nebula Pro</title>
<style>
:root{
  --infodose-bg:#0b0b0f; --panel:#12121a; --ink:#eaeaf7; --mut:#aeb0c7;
  --luxara:#FF4CF0; --ignyra:#29D3FF; --aion:#8A5CFF; --line:#212236;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:
  radial-gradient(60vw 60vh at 90% -10%, #17172b 0%, transparent 60%),
  radial-gradient(60vw 60vh at -10% 110%, #0f0f19 0%, transparent 60%),
  var(--infodose-bg); color:var(--ink); font:500 16px/1.55 Inter, system-ui, -apple-system, Segoe UI, Roboto;}
.header{position:sticky; top:0; z-index:20; display:flex; align-items:center; gap:10px;
  padding:12px 14px; background:linear-gradient(180deg,#131322,#0f0f18); border-bottom:1px solid var(--line);}
.logo{font-weight:800; letter-spacing:.4px; cursor:pointer}
.badge{font-size:12px; color:var(--ignyra); border:1px solid #2a2a44; padding:4px 8px; border-radius:999px}
.wrap{max-width:820px;margin:0 auto;padding:8px 14px 90px}
.msg{max-width:78%; padding:10px 12px; border-radius:14px; margin:8px 0; word-wrap:break-word;}
.msg.me{margin-left:auto;background:#241834;color:#f3e9ff; border:1px solid rgba(255,255,255,.08);}
.msg.ai{margin-right:auto;background:#0f1b2a;color:#e9f6ff; border:1px solid rgba(255,255,255,.08);}
.time{font-size:12px; opacity:.65; margin-top:2px}
.composer{position:fixed; left:0; right:0; bottom:0; z-index:30; background:linear-gradient(180deg,#131322,#0f0f18);
  border-top:1px solid var(--line); padding:10px 12px;}
.row{display:flex; gap:8px; align-items:center}
input[type="text"]{flex:1; background:#0f0f18; color:#ink; border:1px solid #202038; border-radius:12px; padding:12px}
.btn{background:#17172a;border:1px solid #272746;color:var(--ink);border-radius:12px;padding:10px 12px;cursor:pointer}
.btn:active{transform:translateY(1px)}
.toggle{display:flex; gap:6px; align-items:center; font-size:13px; color:var(--mut)}
.small{font-size:12px; color:var(--mut)}
.icon{font-size:18px}
</style>
</head>
<body>
  <div class="header">
    <div class="logo" id="logo">DUAL ‚Ä¢ CHAT</div>
    <span class="badge" id="statusBadge">Cloud</span>
    <div style="margin-left:auto" class="small">Luxara‚ÜîIgnYra ‚Ä¢ AION</div>
  </div>
  <div class="wrap" id="feed">
    <div class="msg ai"><div>Bem-vindo ao DualChat Nebula Pro. Fale comigo, ou digite abaixo.</div><div class="time">agora</div></div>
  </div>

  <div class="composer">
    <div class="row" style="margin-bottom:6px">
      <label class="toggle"><input type="checkbox" id="modeArche" /> 12 Arqu√©tipos</label>
      <label class="toggle"><input type="checkbox" id="modeDual" checked/> Dual (sua voz)</label>
      <label class="toggle"><input type="checkbox" id="modeSpeak" checked/> Falar respostas</label>
    </div>
    <div class="row">
      <button class="btn" id="btnMic" title="gravar">üéôÔ∏è</button>
      <input id="text" type="text" placeholder="Escreva‚Ä¶ use ! para alternar vozes"/>
      <button class="btn" id="btnSend" title="enviar">‚ö°</button>
    </div>
  </div>

<script>
(function(){
  const $ = s=>document.querySelector(s);
  const feed=$('#feed'), txt=$('#text'), badge=$('#statusBadge');
  const modeArche=$('#modeArche'), modeDual=$('#modeDual'), modeSpeak=$('#modeSpeak');
  // status
  badge.textContent = (localStorage.getItem('DUAL_BACKEND')||'') ? 'LAN' : 'Cloud';
  function addMsg(role,content){
    const el=document.createElement('div'); el.className='msg '+role;
    el.innerHTML='<div>'+content+'</div><div class="time">'+new Date().toLocaleTimeString()+'</div>';
    feed.appendChild(el); el.scrollIntoView({behavior:'smooth',block:'end'});
  }
  // TTS
  let VOICES=[]; function refresh(){ VOICES=speechSynthesis.getVoices(); } refresh(); speechSynthesis.onvoiceschanged=refresh;
  function findVoice(hints){ const L=v=>v?.toLowerCase()||''; for(const v of VOICES){ if(hints.some(h=>L(v.name).includes(h)||L(v.lang).includes(h))) return v; }
    return VOICES.find(v=>/pt-?br/i.test(v.lang))||VOICES[0]; }
  const ARCH=[
    ['NOVA',['natalia','pt-br','luciana'],1.0,1.1],['ATLAS',['ricardo','pt-br'],0.95,0.95],
    ['VITALIS',['victoria','vitoria','pt-br'],1.05,1.0],['PULSE',['joana','pt-br'],1.10,1.1],
    ['SERENA',['serena','sara','pt-br'],0.95,1.2],['AURORA',['aurora','female','pt-br'],1.05,1.15],
    ['H√ìRUS',['horus','male','pt-br'],0.95,0.9],['BLLUE',['bruno','pt-br'],1.0,0.95],
    ['KODUX',['allan','pt-br'],0.98,1.0],['LUMEN',['luana','pt-br'],1.06,1.1],
    ['TERRA',['tiago','pt-br'],0.92,0.9],['TRINITY',['tri','sophia','pt-br'],1.0,1.05]
  ];
  function dualVoice(){ return findVoice(['pt-br','brazil']); }
  function speak(text,voice,rate=1.0,pitch=1.0){ if(!modeSpeak.checked)return; try{
    const u=new SpeechSynthesisUtterance(text); u.voice=voice; u.rate=rate; u.pitch=pitch; u.volume=1;
    speechSynthesis.cancel(); speechSynthesis.speak(u);}catch(e){console.error(e);} }
  async function respond(input){
    const reply='Pulso em expans√£o: '+input; addMsg('ai',reply);
    if(modeArche.checked){ const parts=reply.split('!').filter(Boolean); let i=0;
      for(const p of (parts.length?parts:[reply])){ const [name,hints,rate,pitch]=ARCH[i%ARCH.length]; const v=findVoice(hints); speak(p,v,rate,pitch); i++; } }
    else if(modeDual.checked){ speak(reply, dualVoice(), 1.0,1.0); }
  }
  $('#btnSend').addEventListener('click', async ()=>{ const v=txt.value.trim(); if(!v)return; addMsg('me',v); txt.value=''; await respond(v); });
  txt.addEventListener('keydown', e=>{ if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); $('#btnSend').click(); } });
  $('#btnMic').addEventListener('click', async ()=>{ try{ await navigator.mediaDevices.getUserMedia({audio:true}); addMsg('ai','üéôÔ∏è Microfone liberado.'); }catch{ addMsg('ai','Permiss√£o negada.'); } });
  $('#logo').addEventListener('click', ()=>history.back());
})();</script>
</body>
</html>
